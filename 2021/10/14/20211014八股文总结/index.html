<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="八股文总结, JAVA,咸鱼">
    <meta name="description" content="井冈山的黄土狗，莫得感情的点赞机器，你的联机提醒小助手，老头滚动条的安装带师，P社mod制造工厂，大胡子的忠实拥趸，宇宙神游者，前做题家，失败主义的谋士，单机婆罗门">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>八股文总结 | 四级奇点</title>
    <link rel="icon" type="image/png" href="/Kirby.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">四级奇点</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">四级奇点</div>
        <div class="logo-desc">
            
            井冈山的黄土狗，莫得感情的点赞机器，你的联机提醒小助手，老头滚动条的安装带师，P社mod制造工厂，大胡子的忠实拥趸，宇宙神游者，前做题家，失败主义的谋士，单机婆罗门
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/load_8.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">八股文总结</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Java/">
                                <span class="chip bg-color">Java</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-10-14
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="01-Mysql"><a href="#01-Mysql" class="headerlink" title="01.Mysql"></a>01.Mysql</h1><h2 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h2><blockquote>
<p>  ​    为什么需要事务：数据安全！！！一个业务中涉及N个独立的子业务。</p>
</blockquote>
<table>
<thead>
<tr>
<th>事务隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>读未提交（read-uncommitted）</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>读已提交（read-committed）oracle的默认级别</td>
<td>否</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>可重复读（repeatable-read）mysql默认级别</td>
<td>否</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>串行化（serializable）</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
</tbody></table>
<p>脏读：一个事务读到了另外一个事务还未提交的数据</p>
<p>不可重复读：在一个事务中的两次select操作读取同一个表，数据不相同</p>
<p>幻读：在一个事务中的两次select操作读取同一个表的记录数不同</p>
<p>使用MVCC可以解决幻读的问题</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/8845ddca3b23">MVCC多版本并发控制 - 简书 (jianshu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shoshana-kong/p/11244341.html%EF%BC%88%E6%8E%A8%E8%8D%90%E7%9C%8B%E8%BF%99%E4%B8%AA%EF%BC%89">https://www.cnblogs.com/shoshana-kong/p/11244341.html（推荐看这个）</a></p>
<p>串行化和读未提交实际当中不用，串行化效率太低，读未提交安全性不够。</p>
<p>Oracle提供read committed和serializable，并提供了一个非SQL标准的read-only级别。</p>
<p>读方面在事务这块就上面这几点内容，那写呢？写所涉及的问题是：更新丢失</p>
<h2 id="事务的特性：ACID"><a href="#事务的特性：ACID" class="headerlink" title="事务的特性：ACID"></a>事务的特性：ACID</h2><ul>
<li>原子性（Atomicity）：事务是一个原子操作，由一系列动作组成。事务的原子性确保动作要么全部完成，要么完全不起作用。</li>
<li>一致性（Consistency）：一旦事务完成（不管成功还是失败），系统必须确保它所建模的业务处于一致的状态，而不会是部分完成部分失败。在现实中的数据不应该被破坏。</li>
<li>隔离性（Isolation）：可能有许多事务会同时处理相同的数据，因此每个事务都应该与其他事务隔离开来，防止数据损坏。</li>
<li>持久性（Durability）：一旦事务完成，无论发生什么系统错误，它的结果都不应该受到影响，这样就能从任何系统崩溃中恢复过来。通常情况下，事务的结果被写到持久化存储器中。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/paopaopotter/article/details/79259686">(127条消息) 数据库第一类第二类丢失更新_爱米粒的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1654809273831660358&amp;wfr=spider&amp;for=pc">详解MySQL的Redo日志与Undo日志 (baidu.com)</a></p>
<h2 id="mysql数据库常⽤的引擎"><a href="#mysql数据库常⽤的引擎" class="headerlink" title="mysql数据库常⽤的引擎"></a>mysql数据库常⽤的引擎</h2><p>MyISAM,InnoDB,MEMORY</p>
<p><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1655327558614401593&amp;wfr=spider&amp;for=pc">Mysql各种存储引擎对比总结 (baidu.com)</a></p>
<h2 id="执⾏select-count-from-table哪种引擎速度快"><a href="#执⾏select-count-from-table哪种引擎速度快" class="headerlink" title="执⾏select count(*) from table哪种引擎速度快"></a>执⾏select count(*) from table哪种引擎速度快</h2><p>MyISAM 因为会把每个表的总记录数保存起来</p>
<p>InnoDB不会保存，每次重新计算</p>
<h2 id="Statement和PrepareStatement的区别"><a href="#Statement和PrepareStatement的区别" class="headerlink" title="Statement和PrepareStatement的区别"></a>Statement和PrepareStatement的区别</h2><p>Preparestatement是预编译的，可以防止sql注入；可以缓存，执行效率比statement要高一些。</p>
<p>statement用户执行静态sql语句，不能防止sql注入；</p>
<h2 id="索引失效的几种情况"><a href="#索引失效的几种情况" class="headerlink" title="索引失效的几种情况"></a>索引失效的几种情况</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wushaopei/p/12283647.html">面试题： MySQL 索引失效的10大原因 - 维宇空灵 - 博客园 (cnblogs.com)</a></p>
<p>select * from 表 where 条件1  and 条件2 or 条件3</p>
<p>select * from 表 where 条件1  and （条件2 or 条件3）</p>
<ul>
<li>  or 会导致索引失效</li>
<li>  like 最左匹配原则 like  ‘%XX%’    不要左边的%</li>
<li>  多列索引，从第一个字段开始匹配（带头大哥不能死，中间兄弟不能断！）</li>
</ul>
<h2 id="Sql语句优化（如何避免索引失效）"><a href="#Sql语句优化（如何避免索引失效）" class="headerlink" title="Sql语句优化（如何避免索引失效）"></a>Sql语句优化（如何避免索引失效）</h2><ul>
<li><p>应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描</p>
</li>
<li><p>应尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描</p>
</li>
<li><p>应尽量避免在 where 子句中使用 or 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描，如：<br>select id from t where num=10 or num=20<br>可以这样查询：<br>select id from t where num=10<br>union all<br>select id from t where num=20 </p>
</li>
<li><p>in 和 not in 也要慎用，否则会导致全表扫描，如：<br>select id from t where num in(1,2,3)<br>对于连续的数值，能用 between 就不要用 in 了：<br>select id from t where num between 1 and 3   </p>
</li>
<li><p>like后面的值不要用%开头，下面的查询也将导致全表扫描：<br>select id from t where name like ‘%abc%’</p>
</li>
<li><p>应尽量避免在 where 子句中对字段进行表达式操作，这将导致引擎放弃使用索引而进行全表扫描</p>
<p>select id from t where num/2=100<br>应改为:<br>select id from t where num=100*2</p>
</li>
<li><p>应尽量避免在where子句中对字段进行函数操作，这将导致引擎放弃使用索引而进行全表扫描。如：<br>select id from t where substring(name,1,3)=’abc’–name以abc开头的id<br>应改为:<br>select id from t where name like ‘abc%’ </p>
</li>
<li><p>很多时候用 exists 代替 in 是一个好的选择：<br>select num from a where num in(select num from b)<br>用下面的语句替换：<br>select num from a where exists(select 1 from b where num=a.num)</p>
</li>
<li><p>并不是所有列上都适合建索引；，SQL是根据表中数据来进行查询优化的，当索引列有大量数据重复时，SQL查询可能不会去利用索引，如一表中有字段sex，male、female几乎各一半，那么即使在sex上建了索引也对查询效率起不了作用。</p>
</li>
<li><p>索引并不是越多越好，索引固然可以提高相应的 select 的效率，但同时也降低了 insert 及 update 的效率，<br>因为 insert 或 update 时有可能会重建索引，所以怎样建索引需要慎重考虑，视具体情况而定。<br>一个表的索引数最好不要超过6个，若太多则应考虑一些不常使用到的列上建的索引是否有必要。 </p>
</li>
<li><p>.尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型，这会降低查询和连接的性能，并会增加存储开销。<br>这是因为引擎在处理查询和连接时会逐个比较字符串中每一个字符，而对于数字型而言只需要比较一次就够了。 </p>
</li>
<li><p>.尽可能的使用 varchar 代替 char ，因为首先变长字段存储空间小，可以节省存储空间，<br>其次对于查询来说，在一个相对较小的字段内搜索效率显然要高些。</p>
</li>
<li><p>任何地方都不要使用 select * from t ，用具体的字段列表代替“*”，不要返回用不到的任何字段。</p>
</li>
<li><p>如果删除数据库里的所有记录，使用truncate table，这个比delete table的效率高很多</p>
</li>
</ul>
<h2 id="如何知道优化的效果？"><a href="#如何知道优化的效果？" class="headerlink" title="如何知道优化的效果？"></a>如何知道优化的效果？</h2><p>学会查看SQL执行计划（执行计划中的几个字段要能解释一下）</p>
<h2 id="关联子查询更新表"><a href="#关联子查询更新表" class="headerlink" title="关联子查询更新表"></a>关联子查询更新表</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> tb_a out_ta 
<span class="token keyword">set</span> b<span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> b <span class="token keyword">from</span> tb_b inner_b <span class="token keyword">where</span> out_ta<span class="token punctuation">.</span>a<span class="token operator">=</span>inner_b<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>





<p>有两个表tb_a（数据参考第⼀个图）和tb_b（数据参考第⼆个图）,可以是⽤两个表中的a列进⾏表关联， </p>
<p>要求使⽤tb_b表中的b列中的值，更新tb_a表中b列的值，注意更新完成之后的结果请看第三个图： </p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225105425.png" alt="image-20210225105419473"></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225105430.png" alt="image-20210225105430398"></p>
<p>执⾏结果如图 </p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225105446.png" alt="image-20210225105446310"></p>
<p>含义：<br>      出现在其他语句中的select语句，称为子查询或内查询<br>      外部的查询语句，称为主查询或外查询</p>
<p>分类：<br>按子查询出现的位置：<br>            select后面<br>                  仅仅支持标量子查询<br>            from后面<br>                  支持表子查询<br>            where或having后面： ※<br>                  支持标量子查询（单行） ※<br>                  支持列子查询（多行） ※<br>                  支持行子查询<br>            exists后面(相关子查询)<br>                  支持标量子查询<br>                  支持列子查询<br>                  支持行子查询<br>                  支持表子查询</p>
<p>按结果集的行列数不同：<br>            标量子查询(结果集只有一行一列)<br>            列子查询(结果集只有一列多行)<br>            行子查询(结果集有一行多列)<br>            表子查询(结果集一般为多行多列)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47261774/article/details/110389201">https://blog.csdn.net/weixin_47261774/article/details/110389201</a></p>
<h2 id="使用过哪些数据库的索引"><a href="#使用过哪些数据库的索引" class="headerlink" title="使用过哪些数据库的索引"></a>使用过哪些数据库的索引</h2><p>从不同的角度描述有如下类型：</p>
<p>普通索引</p>
<p>唯一索引</p>
<p>复合索引</p>
<p>单列索引</p>
<p>主键索引</p>
<p>聚簇索引</p>
<p>非聚簇索引</p>
<h2 id="Mysql的主从复制是怎么实现的"><a href="#Mysql的主从复制是怎么实现的" class="headerlink" title="Mysql的主从复制是怎么实现的"></a>Mysql的主从复制是怎么实现的</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225111008.png" alt="image-20210225111008504"></p>
<ul>
<li>主服务器开启binlog配置</li>
<li>从服务器开启线程，从主服务的binlog中获取最新的操作日志</li>
<li>从服务器获取到主服务器的binog日志后，生成relayLog（重做日志）</li>
<li>从服务器根据relayLog重新操作一遍</li>
</ul>
<h2 id="说⼀下怎么防⽌超卖，SQL怎么写"><a href="#说⼀下怎么防⽌超卖，SQL怎么写" class="headerlink" title="说⼀下怎么防⽌超卖，SQL怎么写"></a>说⼀下怎么防⽌超卖，SQL怎么写</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> tb_boods <span class="token keyword">set</span> stock<span class="token operator">=</span>stock<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">where</span> stock<span class="token operator">&gt;=</span><span class="token number">1</span> <span class="token operator">and</span> goods_id<span class="token operator">=</span><span class="token number">123</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="去除一条重复记录"><a href="#去除一条重复记录" class="headerlink" title="去除一条重复记录"></a>去除一条重复记录</h2><p>数据库3个字段，姓名，科⽬，分数，插⼊数据不⼩⼼插⼊了重复数据，怎么去重，重复数据保留⼀ </p>
<p>个，SQL语句实现（delete from tb_user where id= (select a.id from (select count(id),id from </p>
<p>tb_user group by username,cls,score having count(id)&gt;1 limit 0,1) a)） </p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226144305.png" alt="image-20210226144305686"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">
<span class="token keyword">delete</span> b <span class="token keyword">from</span> t_user b <span class="token keyword">where</span> <span class="token operator">not</span> <span class="token keyword">exists</span>   <span class="token punctuation">(</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>aid <span class="token keyword">from</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token keyword">as</span> aid<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token punctuation">,</span>a<span class="token punctuation">.</span>username<span class="token punctuation">,</span>a<span class="token punctuation">.</span>cls<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score  <span class="token keyword">from</span> 

t_user a <span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>username<span class="token punctuation">,</span>a<span class="token punctuation">.</span>cls<span class="token punctuation">,</span>a<span class="token punctuation">.</span>score <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">1</span>
<span class="token punctuation">)</span> c <span class="token keyword">where</span> b<span class="token punctuation">.</span>id<span class="token operator">=</span>c<span class="token punctuation">.</span>aid

<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="生产中是否使用过事务隔离级别-怎么使用的？当时遇到坑是怎么解决的？"><a href="#生产中是否使用过事务隔离级别-怎么使用的？当时遇到坑是怎么解决的？" class="headerlink" title="生产中是否使用过事务隔离级别 怎么使用的？当时遇到坑是怎么解决的？"></a>生产中是否使用过事务隔离级别 怎么使用的？当时遇到坑是怎么解决的？</h2><p>默认是可重复读 ，不能解决幻读</p>
<h1 id="02-JAVA基础"><a href="#02-JAVA基础" class="headerlink" title="02.JAVA基础"></a>02.JAVA基础</h1><h2 id="常见的异常类有哪些"><a href="#常见的异常类有哪些" class="headerlink" title="常见的异常类有哪些"></a>常见的异常类有哪些</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>Throwable<ul>
<li>Exception<ul>
<li>  RuntimeException</li>
<li>  IOException  -&gt; 直接继承Exception</li>
</ul>
</li>
<li>  Error</li>
</ul>
</li>
</ul>
<h3 id="java-lang-ArrayIndexOutOfBoundsException（数组越界）"><a href="#java-lang-ArrayIndexOutOfBoundsException（数组越界）" class="headerlink" title="java.lang.ArrayIndexOutOfBoundsException（数组越界）"></a>java.lang.ArrayIndexOutOfBoundsException（数组越界）</h3><h3 id="java-lang-NullPointerException-空指针异常"><a href="#java-lang-NullPointerException-空指针异常" class="headerlink" title="java.lang.NullPointerException 空指针异常"></a>java.lang.NullPointerException 空指针异常</h3><h3 id="java-lang-ArithmeticException-包含除数为0的异常"><a href="#java-lang-ArithmeticException-包含除数为0的异常" class="headerlink" title="java.lang.ArithmeticException 包含除数为0的异常"></a>java.lang.ArithmeticException 包含除数为0的异常</h3><h3 id="java-lang-ClassCastException（java强制类型转换异常）"><a href="#java-lang-ClassCastException（java强制类型转换异常）" class="headerlink" title="java.lang.ClassCastException（java强制类型转换异常）"></a>java.lang.ClassCastException（java强制类型转换异常）</h3><h3 id="java-util-ConcurrentModificationException（https-www-cnblogs-com-zhuyeshen-p-10956822-html）一遍循环列表，一边修改"><a href="#java-util-ConcurrentModificationException（https-www-cnblogs-com-zhuyeshen-p-10956822-html）一遍循环列表，一边修改" class="headerlink" title="java.util.ConcurrentModificationException（https://www.cnblogs.com/zhuyeshen/p/10956822.html）一遍循环列表，一边修改"></a>java.util.ConcurrentModificationException（<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhuyeshen/p/10956822.html%EF%BC%89%E4%B8%80%E9%81%8D%E5%BE%AA%E7%8E%AF%E5%88%97%E8%A1%A8%EF%BC%8C%E4%B8%80%E8%BE%B9%E4%BF%AE%E6%94%B9">https://www.cnblogs.com/zhuyeshen/p/10956822.html）一遍循环列表，一边修改</a></h3><h2 id="方法传值和传引用"><a href="#方法传值和传引用" class="headerlink" title="方法传值和传引用"></a>方法传值和传引用</h2><p>passReference方法传入的Dog是引用堆空间中的dog实例，所以在方法里面修改dog的属性name，方法结束后，依然有效</p>
<p>passValue方法传入的0，方法执行结束后，passValue的栈空间被回收，pass方法里面的k也被回收。此时main方法里的k依然等于0</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210304161858.png" alt="image-20210304161852103"></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//Talk is cheap Show me you code</span>
<span class="token comment">//-- String str = "hello";</span>
<span class="token comment">//-- method(str)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">{</span>
   str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"l"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//new String("he##o")</span>
<span class="token punctuation">}</span>  
<span class="token comment">//-- Sysout(str);</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="String类的equals方法做了些什么？为什么String类需要重写equals方法？"><a href="#String类的equals方法做了些什么？为什么String类需要重写equals方法？" class="headerlink" title="String类的equals方法做了些什么？为什么String类需要重写equals方法？"></a>String类的equals方法做了些什么？为什么String类需要重写equals方法？</h2><p>String类集成Object类，Object类中的equals是用==比较内存地址，String类重写equals方法后，就可以比较对象的内容。</p>
<h2 id="String类-和equals本质上的区别是什么"><a href="#String类-和equals本质上的区别是什么" class="headerlink" title="String类==和equals本质上的区别是什么"></a>String类==和equals本质上的区别是什么</h2><p>==比较两个对象的内存地址是否相同，equals被重写之后，比较String中的char[]数组里的内容是否完全相同。</p>
<h2 id="String为什么不可变？我们两个字符串拼接的时候”-”这样不是可变的了吗？为什么？"><a href="#String为什么不可变？我们两个字符串拼接的时候”-”这样不是可变的了吗？为什么？" class="headerlink" title="String为什么不可变？我们两个字符串拼接的时候”+”这样不是可变的了吗？为什么？"></a>String为什么不可变？我们两个字符串拼接的时候”+”这样不是可变的了吗？为什么？</h2><p>String不可变一个是从安全的原因考虑，还有就是效率会高。用+拼接两个字符串，实际上并没有改变原来的对象的值，而是产生了一个新的对象。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> a<span class="token operator">=</span><span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> b<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"def"</span><span class="token punctuation">)</span>
<span class="token class-name">String</span> k<span class="token operator">=</span>a<span class="token operator">+</span>b<span class="token punctuation">;</span> 

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>a+b在虚拟机中会转换成两个StringBuilder使用append操作，结果又会使用toString方法转换回String</p>
<h2 id="Java类初始化过程中执行顺序"><a href="#Java类初始化过程中执行顺序" class="headerlink" title="Java类初始化过程中执行顺序"></a>Java类初始化过程中执行顺序</h2><p>总的原则：先静态，后非静态，最后构造函数</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test7</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Derived</span> d<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        Base base = new Base();</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">Base</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> staticValue<span class="token operator">=</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">baseStaticFieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类的静态代码块2222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类的静态代码块1111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类的普通代码块BBBB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> normalValue<span class="token operator">=</span><span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">baseFieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类的普通代码块AAAA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类的构造函数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span><span class="token punctuation">{</span>
    <span class="token keyword">static</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类的静态代码块3333"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> staticValue<span class="token operator">=</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">staticfieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类的静态代码块444"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类的普通代码块CCC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> normalValue<span class="token operator">=</span><span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">fieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类的普通代码块DDDD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类的构造函数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Log</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">baseFieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类非静态变量赋值"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"父类非静态变量赋值"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">baseStaticFieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"父类静态变量赋值"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"父类静态变量赋值"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">fieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类非静态变量赋值"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"子类非静态变量赋值"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">staticfieldInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"子类静态变量赋值"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"子类静态变量赋值"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Java基本数据类型及其封装类型有什么本质上的区别"><a href="#Java基本数据类型及其封装类型有什么本质上的区别" class="headerlink" title="Java基本数据类型及其封装类型有什么本质上的区别"></a>Java基本数据类型及其封装类型有什么本质上的区别</h2><ul>
<li><p>基本数据类型</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FinanceController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> kk<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//常量 --方法区</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> mm<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 静态变量--方法区</span>

    <span class="token keyword">private</span> <span class="token class-name">FinanceService</span> financeService<span class="token punctuation">;</span> <span class="token comment">//成员变量--堆空间</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//成员变量--堆空间</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">financeCollect</span><span class="token punctuation">(</span><span class="token class-name">Long</span> policyId<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//局部变量 --栈</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>包装类型新建的实例都是分配在堆空间上的，包装类型都是final修饰的，定义后不可变。</p>
</li>
</ul>
<h2 id="new-String-“a”-出现了⼏个对象"><a href="#new-String-“a”-出现了⼏个对象" class="headerlink" title="new String(“a”) 出现了⼏个对象"></a>new String(“a”) 出现了⼏个对象</h2><p>第一次执行这个方法：</p>
<p>产生两个对象</p>
<p>常量池里面一个，堆空间里面一个</p>
<p>第二次执行这个方法：</p>
<p>只产生一个对象，在堆空间</p>
<h2 id="break-continue-使用"><a href="#break-continue-使用" class="headerlink" title="break,continue 使用"></a>break,continue 使用</h2><ul>
<li>break退出循环</li>
<li>continue结束当前循环，继续下一个循环</li>
</ul>
<h2 id="比较一下-和equals的区别"><a href="#比较一下-和equals的区别" class="headerlink" title="比较一下==和equals的区别"></a>比较一下==和equals的区别</h2><p>默认在Object里面是没有区别，都是==,比较对象的内存地址</p>
<p>在子类里面，一般我们都会重写equals方法，同时也会重写hashCode方法</p>
<pre class="line-numbers language-none"><code class="language-none">两个对象Obj1和Obj2，如果Obj1.equals(Obj2),那么Obj1.hashCode==Obj2.hashCode一定为true
如果Obj1.hashCode==Obj2.hashCode，那么Obj1.equals(Obj2)不一定为true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h2 id="Object有哪些方法"><a href="#Object有哪些方法" class="headerlink" title="Object有哪些方法"></a>Object有哪些方法</h2><pre class="line-numbers language-none"><code class="language-none">hashCode()
equals(Object obj)
两个对象Obj1和Obj2，如果Obj1.equals(Obj2),那么Obj1.hashCode==Obj2.hashCode一定为true
如果Obj1.hashCode==Obj2.hashCode，那么Obj1.equals(Obj2)不一定为true
clone() 
toString()
notify()
notifyAll()
wait()
finalize()如果重写了这个方法，虚拟机在做垃圾回收的时候，会调用对象的这个方法
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>重写hashCode和equals方法举例</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">31</span><span class="token operator">*</span>userId <span class="token operator">+</span> userName<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">31</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">User</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        o<span class="token punctuation">.</span>getUserName<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userName<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="接⼝和抽象类的区别"><a href="#接⼝和抽象类的区别" class="headerlink" title="接⼝和抽象类的区别"></a>接⼝和抽象类的区别</h2><table>
<thead>
<tr>
<th>接口（Interface）</th>
<th>抽象类（Abstract class）</th>
</tr>
</thead>
<tbody><tr>
<td>可以多继承</td>
<td>只能有一个父类</td>
</tr>
<tr>
<td>JDK1.8里，接口也可以定义默认方法，但是在jdk1.8前，接口里面不能定义普通方法</td>
<td>可以定义抽象方法，也可以定义普通方法</td>
</tr>
<tr>
<td>接口中不能定义代码块</td>
<td>可以定义代码块</td>
</tr>
<tr>
<td>不能有构造方法</td>
<td>可以有构造方法</td>
</tr>
<tr>
<td>接口可以包含变量、方法；变量被隐士指定为public static final，方法被隐士指定为public abstract（JDK1.8之前）</td>
<td>public或者protected，默认为public</td>
</tr>
</tbody></table>
<h2 id="java的基本数据类型以及取值范围"><a href="#java的基本数据类型以及取值范围" class="headerlink" title="java的基本数据类型以及取值范围"></a>java的基本数据类型以及取值范围</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>byte</th>
<th>short</th>
<th>int</th>
<th>long</th>
<th>char</th>
<th>float</th>
<th>double</th>
<th>boolean</th>
</tr>
</thead>
<tbody><tr>
<td>字节数</td>
<td>1字节</td>
<td>2字节</td>
<td>4字节</td>
<td>8字节</td>
<td>2字节</td>
<td>4字节</td>
<td>8字节</td>
<td>4字节</td>
</tr>
<tr>
<td>取值范围</td>
<td>-2^7到2^7-1</td>
<td>-2^15到2^15-1</td>
<td>-2^31到2^31-1</td>
<td>-2^63到2^63-1</td>
<td>-2^15到2^15-1</td>
<td>-2^31到2^31-1</td>
<td>-2^63到2^63-1</td>
<td>jvm编译后用int表示</td>
</tr>
</tbody></table>
<h2 id="String、Stringbuffer、Stringbuilder的区别"><a href="#String、Stringbuffer、Stringbuilder的区别" class="headerlink" title="String、Stringbuffer、Stringbuilder的区别"></a>String、Stringbuffer、Stringbuilder的区别</h2><table>
<thead>
<tr>
<th></th>
<th>String</th>
<th>StringBuffer</th>
<th>StringBuilder</th>
</tr>
</thead>
<tbody><tr>
<td>可变性</td>
<td>不可变类型</td>
<td>可变类型</td>
<td>可变类型</td>
</tr>
<tr>
<td>线程安全</td>
<td>是</td>
<td>是</td>
<td>不是</td>
</tr>
<tr>
<td>效率</td>
<td>jdk1.8以前，使用+拼接字符串，会产生很多对象，效率低，浪费空间。jdk1.8会默认优化，使用StringBuilder来操作。</td>
<td>线程安全，效率比StringBuilder低一些</td>
<td>线程不安全，效率高</td>
</tr>
</tbody></table>
<h2 id="String为什么设计成不可变的"><a href="#String为什么设计成不可变的" class="headerlink" title="String为什么设计成不可变的"></a>String为什么设计成不可变的</h2><p> 在Java中将String设计成不可变的是综合考虑到各种因素的结果,想要理解这个问题,需要综合<strong>内存,同步,数据结构以及安全</strong>等方面的考虑. </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/czwbig/p/11127124.html">Java内存区域（运行时数据区域）和内存模型（JMM） - czwbig - 博客园 (cnblogs.com)</a></p>
<h2 id="String类和char-那个更适合做密码"><a href="#String类和char-那个更适合做密码" class="headerlink" title="String类和char[]那个更适合做密码"></a>String类和char[]那个更适合做密码</h2><p><strong>安全角度考虑</strong></p>
<p>如果内存镜像被dump出来，String容易被看到</p>
<p>如果使用log打印，String也是明文，但是使用char[]，打印出来只能看到数组的内存地址</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Log4j</span> 和 <span class="token class-name">SLF4j</span>    log4j<span class="token operator">-</span>slf4fj<span class="token operator">-</span><span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<h2 id="深拷⻉和浅拷⻉了解吗"><a href="#深拷⻉和浅拷⻉了解吗" class="headerlink" title="深拷⻉和浅拷⻉了解吗"></a>深拷⻉和浅拷⻉了解吗</h2><p>浅拷贝</p>
<p>被克隆的对象需要实现Cloneable接口并且重写clone方法</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">implements</span> <span class="token class-name">Cloneable</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">CloneNotSupportedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224112837.png" alt="image-20210224112836915"></p>
<p>深拷贝的时候，在上图中Address也会被完全复制一份，所以，student1和student2里面的addr指向不同的Address对象，相互不影响。</p>
<h3 id="请说一下深拷贝的方法"><a href="#请说一下深拷贝的方法" class="headerlink" title="请说一下深拷贝的方法"></a>请说一下深拷贝的方法</h3><ul>
<li>使用ObjectOutputStream/ObjectInputStream把对象序列化和反序列化</li>
</ul>
<p>注意：实现了Serializable接口的对象才能被序列化</p>
<pre class="line-numbers language-none"><code class="language-none">public class C implements Serializable<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>使用一些序列化工具Jackson，fastjson，gson</li>
</ul>
<h2 id="反射创建对象（Class）的⽅式"><a href="#反射创建对象（Class）的⽅式" class="headerlink" title="反射创建对象（Class）的⽅式"></a>反射创建对象（Class）的⽅式</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">1.</span>使用类名<span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Test</span><span class="token punctuation">&gt;</span></span> testClass <span class="token operator">=</span> <span class="token class-name">Test</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">2.</span>Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> testClass2 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.woniu30.Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">3.</span>通过实例变量<span class="token punctuation">.</span>getClass方法
<span class="token class-name">Test</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h2 id="抽象类在什么场景下使⽤"><a href="#抽象类在什么场景下使⽤" class="headerlink" title="抽象类在什么场景下使⽤"></a>抽象类在什么场景下使⽤</h2><p>抽象类一般是实现接口，并且把子类的通用实现写在抽象类的方法中，把子类个性化的部分定义成抽象方法，等待子类自己去实现；</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractAnimal</span> <span class="token keyword">implements</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"动物在跑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span>  <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAnimal</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"猫在喵喵。。。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAnimal</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"汪。。。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

        <span class="token class-name">Animal</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Animal</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dog<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cat<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>方法形参</p>
<p>传值和传引用</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringBuffer</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">rp1</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">rp2</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rp1</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span><span class="token punctuation">{</span>
        s<span class="token operator">=</span>s<span class="token operator">+</span><span class="token string">"aaaa"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rp2</span><span class="token punctuation">(</span><span class="token class-name">StringBuffer</span> bf<span class="token punctuation">)</span><span class="token punctuation">{</span>
       bf<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"kkkkk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225121719.png" alt="image-20210225121719656"></p>
<h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> userId<span class="token punctuation">,</span> <span class="token class-name">String</span> userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> userId<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userName <span class="token operator">=</span> userName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">Integer</span> userId<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> userId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userName <span class="token operator">=</span> userName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"User{"</span> <span class="token operator">+</span>
                <span class="token string">"userId="</span> <span class="token operator">+</span> userId <span class="token operator">+</span>
                <span class="token string">", userName='"</span> <span class="token operator">+</span> userName <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//使用反射创建user对象，并且调用方法给字段赋值</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchMethodException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">,</span> <span class="token class-name">InvocationTargetException</span><span class="token punctuation">,</span> <span class="token class-name">InstantiationException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchFieldException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> userClass <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.woniu30.User"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> constructor <span class="token operator">=</span> userClass<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span>constructor<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Field</span> userName <span class="token operator">=</span> userClass<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"userName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userName<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Method</span> m <span class="token operator">=</span> userClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"setUserName"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span><span class="token string">"woniu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="comparable与comparator两种⽐较⽅式有什么区别"><a href="#comparable与comparator两种⽐较⽅式有什么区别" class="headerlink" title="comparable与comparator两种⽐较⽅式有什么区别"></a>comparable与comparator两种⽐较⽅式有什么区别</h2><p>Comparable 是排序接口；若一个类实现了 Comparable 接口，就意味着 “该类支持排序”。而 Comparator 是比较器；我们若需要控制某个类的次序，可以建立一个 “该类的比较器” 来进行排序。<br>  前者应该比较固定，和一个具体类相绑定，而后者比较灵活，它可以被用于各个需要比较功能的类使用。可以说前者属于 “静态绑定”，而后者可以 “动态绑定”。<br>  我们不难发现：Comparable 相当于 “内部比较器”，而 Comparator 相当于 “外部比较器”。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013256816/article/details/50899416">https://blog.csdn.net/u013256816/article/details/50899416</a></p>
<h1 id="03-JAVA高级"><a href="#03-JAVA高级" class="headerlink" title="03.JAVA高级"></a>03.JAVA高级</h1><h2 id="AQS实现原理"><a href="#AQS实现原理" class="headerlink" title="AQS实现原理"></a>AQS实现原理</h2><p>AQS全名：AbstractQueuedSynchronizer，是并发容器J.U.C（java.lang.concurrent）下locks包内的一个类。它实现了一个<strong>FIFO</strong>(FirstIn、FisrtOut先进先出)的队列。底层实现的数据结构是一个<strong>双向链表</strong>。改进版的CLH队列</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210317112559.png" alt="image-20210317112559331"></p>
<p>state代表公共资源的状态，当state=1的时候，说明被某个线程锁定；当state=0的时候，说明没有被锁定，线程可以争抢。</p>
<p>lock锁获取过程是使用CAS操作改变state的值，如果成功，则锁获取成功；如果失败则把节点通过CAS操作加到队列尾部。</p>
<p>对于非公平锁来说，每个线程在入队之前会尝试获取一下锁，如果获取不成功才会入队尾；</p>
<p>进入到队列中的线程会进入阻塞状态。</p>
<p>lock锁的释放过程：当占用锁的线程释放了锁后，会在队列头部寻找有效的节点，唤醒其中的线程去通过CAS争夺锁，当获取锁后，使用资源结束后，会继续唤醒队列中的下一个有效节点。</p>
<p>AQS:state 当前线程 CAS（改变state的值）</p>
<h2 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h2><p>强引用：使用new创建的对象，虚拟机在即使OOM也不会回收，除非这个对象没有任何引用指向它</p>
<p>弱引用：垃圾回收一旦发现，就要回收</p>
<p>软引用：内存不足就回收</p>
<p><strong>虚引用</strong>顾名思义，就是<strong>形同虚设</strong>，<strong>虚引用</strong>主要用来<strong>跟踪对象</strong>被垃圾回收器<strong>回收</strong>的活动</p>
<p>几个重要的方法：</p>
<p>set()</p>
<p>get()</p>
<p>remove()</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210119170138.png" alt="image-20210119170138583"></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210119092126.png" alt="image-20210119003833214"></p>
<p>上面这张图详细的揭示了ThreadLocal和Thread以及ThreadLocalMap三者的关系。</p>
<p>1、Thread中有一个map，就是ThreadLocalMap</p>
<p>2、ThreadLocalMap的key是ThreadLocal，值是我们自己设定的。</p>
<p>3、ThreadLocal是一个弱引用，当为null时，会被当成垃圾回收</p>
<p><strong>4、重点来了，突然我们ThreadLocal是null了，也就是要被垃圾回收器回收了，如果线程是在线程池中，那么线程用完是不会被销毁的，但是此时我们的ThreadLocalMap生命周期和Thread的一样，它不会回收，这时候就出现了一个现象。那就是ThreadLocalMap的key没了，但是value还在，这就造成了内存泄漏。</strong></p>
<p><strong>解决办法：使用完ThreadLocal后，执行remove操作，避免出现内存泄露情况。</strong></p>
<h2 id="父子共享线程变量-InheritableThreadLocal"><a href="#父子共享线程变量-InheritableThreadLocal" class="headerlink" title="父子共享线程变量:InheritableThreadLocal"></a>父子共享线程变量:InheritableThreadLocal</h2><p>代码样例</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">InheritableThreadLocal</span> inheritableThreadLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InheritableThreadLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>

    inheritableThreadLocal<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"父线程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> res <span class="token operator">=</span> inheritableThreadLocal<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"t1===="</span><span class="token operator">+</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>原理：</p>
<p>在Thread的init方法中，如果发现父线程有inheritableThreadLocals变量，就复制到子线程中</p>
<p>在Thread中有这段代码：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">ThreadGroup</span> g<span class="token punctuation">,</span> <span class="token class-name">Runnable</span> target<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>
                  <span class="token keyword">long</span> stackSize<span class="token punctuation">,</span> <span class="token class-name">AccessControlContext</span> acc<span class="token punctuation">,</span>
                  <span class="token keyword">boolean</span> inheritThreadLocals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	。。。。。。。。。。。。。。

    <span class="token class-name">Thread</span> parent <span class="token operator">=</span> <span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>inheritThreadLocals <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>inheritableThreadLocals <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>inheritableThreadLocals <span class="token operator">=</span>
            <span class="token class-name">ThreadLocal</span><span class="token punctuation">.</span><span class="token function">createInheritedMap</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>inheritableThreadLocals<span class="token punctuation">)</span><span class="token punctuation">;</span>
    。。。。。。。。。
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




<p>父子线程里面的HashMap的value保存的对象指向同一堆中的对象。不管在父线程还是子线程中，如果修改了对象中的属性，那么父线程和子线程都能访问到修改后的值</p>
<p>代码演示：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">InheritableThreadLocal</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InheritableThreadLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>



        <span class="token class-name">AObject</span> aObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        in<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>aObject<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"t1===="</span><span class="token operator">+</span>in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    aObject<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除前===主线程"</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AObject</span><span class="token punctuation">)</span>in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除后===主线程"</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">AObject</span><span class="token punctuation">)</span>in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="finalize-方法工作原理"><a href="#finalize-方法工作原理" class="headerlink" title="finalize()方法工作原理"></a>finalize()方法工作原理</h2><p>虚拟机在做垃圾回收之前会调用这个方法。</p>
<h2 id="cglib动态代理怎么实现的"><a href="#cglib动态代理怎么实现的" class="headerlink" title="cglib动态代理怎么实现的"></a>cglib动态代理怎么实现的</h2><p>cglib通过生成被代理类的子类实现，不需要任何接口</p>
<p>需要先引入依赖,如果使用spring的工程，就不用引入依赖了。</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cglib<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cglib<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Enhancer</span> enhancer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MethodInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> <span class="token class-name">MethodProxy</span> proxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"before method run..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Object</span> result <span class="token operator">=</span> proxy<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"after method run..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> sample <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> enhancer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sample<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="JDK动态代理如何实现"><a href="#JDK动态代理如何实现" class="headerlink" title="JDK动态代理如何实现"></a>JDK动态代理如何实现</h2><p>JDK动态代理要求被代理的类实现接口</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserInterface</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">UserInterface</span><span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">protected</span> <span class="token class-name">Integer</span> userId<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> userId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userName <span class="token operator">=</span> userName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"user talk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test5</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Test5</span> test5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserInterface</span> userProxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserInterface</span><span class="token punctuation">)</span>test5<span class="token punctuation">.</span><span class="token function">getProxy</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userProxy<span class="token punctuation">.</span><span class="token function">talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"sun.misc.ProxyGenerator.saveGeneratedFiles"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置系统属性</span>
        <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"前置通知"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//通过反射调用user对象的talk方法</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"后置通知"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>静态代理：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226121235.png" alt="image-20210226121235099"></p>
<ul>
<li>静态代理是程序在运行之前就已经代码就已经生成好了。</li>
<li>动态代理是程序在运行的过程中生成的代理类。</li>
</ul>
<h2 id="对事务有了解吗？生产环境下什么情况下用到了事务-举例说明"><a href="#对事务有了解吗？生产环境下什么情况下用到了事务-举例说明" class="headerlink" title="对事务有了解吗？生产环境下什么情况下用到了事务? 举例说明"></a>对事务有了解吗？生产环境下什么情况下用到了事务? 举例说明</h2><p>事务的四个特性：ACID，原子性，隔离性，持久性，一致性</p>
<p>生产环境对数据库进行修改操作要加事务，在spring中我们使用声明是事务，在方法上增加@Transactional注解，spring会通过动态代理，帮我们提交或者回滚操作</p>
<h2 id="事务是为了保证什么？"><a href="#事务是为了保证什么？" class="headerlink" title="事务是为了保证什么？"></a>事务是为了保证什么？</h2><p>事务可以保证操作的原子性，从而保证数据的完整性。</p>
<h2 id="同一个事务中是读已提交还是读未提交"><a href="#同一个事务中是读已提交还是读未提交" class="headerlink" title="同一个事务中是读已提交还是读未提交"></a>同一个事务中是读已提交还是读未提交</h2><p>读未提交</p>
<h2 id="spring中的-Transactional声明性事务什么时候会失效"><a href="#spring中的-Transactional声明性事务什么时候会失效" class="headerlink" title="spring中的@Transactional声明性事务什么时候会失效"></a>spring中的@Transactional声明性事务什么时候会失效</h2><ul>
<li><p>同一类方法里面调用另一个方法</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">updateOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// update order</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>update方法上面没有加 <code>@Transactional</code> 注解，调用有 <code>@Transactional</code> 注解的 updateOrder 方法，updateOrder 方法上的事务管用吗</p>
<p>再来看下面这个例子</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">updateOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>propagation <span class="token operator">=</span> <span class="token class-name">Propagation</span><span class="token punctuation">.</span>REQUIRES_NEW<span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// update order</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这次在 update 方法上加了 <code>@Transactional</code>，updateOrder 加了 <code>REQUIRES_NEW</code> 新开启一个事务，那么新开的事务管用么？</p>
<p>这两个例子的答案是：不管用！</p>
<p>因为它们发生了自身调用，就调该类自己的方法，而没有经过 Spring 的代理类，默认只有在外部调用事务才会生效，这也是老生常谈的经典问题了。这个的解决方案之一就是在的类中注入自己，用注入的对象再调用另外一个方法，这个不太优雅，另外一个可行的方案可以参考《<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/1TEBnmWynN4nwc6Q-oZfvw">Spring 如何在一个事务中开启另一个事务？</a>》这篇文章。</p>
</li>
<li><p>方法不是 public 的：<code>@Transactional</code> 只能用于 public 的方法上，否则事务不会失效，如果要用在非 public 方法上，可以开启 <code>AspectJ</code> 代理模式。</p>
</li>
<li><p>异常类型错误</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// update order</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"更新错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这样事务也是不生效的，因为默认回滚的是：RuntimeException，如果你想触发其他异常的回滚，需要在注解上配置一下，如：</p>
<p>@Transactional(rollbackFor = Exception.class)</p>
<p>这个配置仅限于 <code>Throwable</code> 异常类及其子类。</p>
</li>
<li><p>异常被吃了：把异常吃了，然后又不抛出来，事务怎么回滚吧！</p>
<pre class="line-numbers language-none"><code class="language-none">@Service
public class OrderServiceImpl implements OrderService {

    @Transactional
    public void updateOrder(Order order) {
        try {
            // update order
        } catch {
            //异常被catch了，无法回滚事务
        }
    }
    
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>数据源没有配置事务管理器</p>
</li>
<li><p>对象实例没有被 Spring 容器管理： <code>@Service</code> 被注释掉，这个类就不会被加载成一个 Bean，那这个类就不会被 Spring 管理了，事务自然就失效了</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// @Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// update order</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>数据库引擎本身不支持事务，例如MyISAM引擎</p>
</li>
<li><p>不支持事务</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">updateOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>propagation <span class="token operator">=</span> <span class="token class-name">Propagation</span><span class="token punctuation">.</span>NOT_SUPPORTED<span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateOrder</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// update order</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Propagation.NOT_SUPPORTED：</strong> 表示不以事务运行，当前若存在事务则挂起，详细的可以参考《<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/RTEMPBB6AFmmdj0uw1SDsg">事务隔离级别和传播机制</a>》这篇文章。</p>
<p>都主动不支持以事务方式运行了，那事务生效也是白搭！</p>
</li>
</ul>
<h1 id="04-JAVA-WEB"><a href="#04-JAVA-WEB" class="headerlink" title="04.JAVA WEB"></a>04.JAVA WEB</h1><h2 id="get-和-post-请求有哪些区别"><a href="#get-和-post-请求有哪些区别" class="headerlink" title="get 和 post 请求有哪些区别"></a>get 和 post 请求有哪些区别</h2><p>GET长度有限制（URL 的最大长度是 2048 个字符），POST对请求长度没有限制</p>
<p>GET只允许请求ASCII字符，POST对编码没有限制，允许请求二进制数据</p>
<p>如果想安全，使用HTTPS协议</p>
<h2 id="说一下-JSP-的-4-种作用域"><a href="#说一下-JSP-的-4-种作用域" class="headerlink" title="说一下 JSP 的 4 种作用域"></a>说一下 JSP 的 4 种作用域</h2><table>
<thead>
<tr>
<th>名称</th>
<th>作用域</th>
</tr>
</thead>
<tbody><tr>
<td>application</td>
<td>在所有应用程序中有效</td>
</tr>
<tr>
<td>session</td>
<td>在当前会话中有效</td>
</tr>
<tr>
<td>request</td>
<td>在当前请求中有效</td>
</tr>
<tr>
<td>page</td>
<td>在当前页面有效</td>
</tr>
</tbody></table>
<h2 id="cookie和session有什么区别"><a href="#cookie和session有什么区别" class="headerlink" title="cookie和session有什么区别"></a>cookie和session有什么区别</h2><p>cookie保存在浏览器端，有大小限制</p>
<p>session保存在服务端，session没有大小显示</p>
<p>session是依赖cookie实现的，session有个sessionid是保存在cookie中的，这个名字叫: JSESSIONID</p>
<p>如果浏览器禁止使用cookie，那么JSESSIONID会放在url后边作为一个请求参数</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/user/query?JSESSIOINID=dfdsfdsfdsfdsdsfds">http://localhost:8080/user/query?JSESSIOINID=dfdsfdsfdsfdsdsfds</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_32392903/article/details/80339292">(127条消息) 集群/分布式环境下5种共享session处理策略_加班ing的博客-CSDN博客_集群session共享</a></p>
<h2 id="forward-和-redirect-的区别？"><a href="#forward-和-redirect-的区别？" class="headerlink" title="forward 和 redirect 的区别？"></a>forward 和 redirect 的区别？</h2><p>forward</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315114540.png" alt="image-20210315114539970"></p>
<p>redirect</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315114854.png" alt="image-20210315114853995"></p>
<h1 id="05-JAVA集合"><a href="#05-JAVA集合" class="headerlink" title="05.JAVA集合"></a>05.JAVA集合</h1><h2 id="继承层次"><a href="#继承层次" class="headerlink" title="继承层次"></a>继承层次</h2><p>java集合中的两大接口：Collection和Map</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224110512.png" alt="image-20210224110512179"></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224110526.png" alt="image-20210224110526743"></p>
<h3 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h3><h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><h5 id="ArrayList和LinkedList区别"><a href="#ArrayList和LinkedList区别" class="headerlink" title="ArrayList和LinkedList区别"></a>ArrayList和LinkedList区别</h5><table>
<thead>
<tr>
<th>比较项</th>
<th>ArrayList</th>
<th>LinkedList</th>
</tr>
</thead>
<tbody><tr>
<td>数据结构</td>
<td>基于数组实现</td>
<td>基于链表实现</td>
</tr>
<tr>
<td>随机查询效率</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>修改效率</td>
<td>低</td>
<td>高</td>
</tr>
</tbody></table>
<h5 id="ArrayList初始化和扩容："><a href="#ArrayList初始化和扩容：" class="headerlink" title="ArrayList初始化和扩容："></a>ArrayList初始化和扩容：</h5><p>new ArrayList(0)—-初始化话容量为0</p>
<p>new ArrayList(n)—-初始化话容量为n</p>
<p>new ArrayList()—-初始化话容量为0</p>
<p>扩容的计算公式：新数组容量=老数组容量+（老数组容量/2）</p>
<h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><p>hashSet有什么特性</p>
<p>为什么hashset是不能重复的</p>
<h4 id="list和set集合的区别"><a href="#list和set集合的区别" class="headerlink" title="list和set集合的区别"></a>list和set集合的区别</h4><table>
<thead>
<tr>
<th>List</th>
<th>Set</th>
</tr>
</thead>
<tbody><tr>
<td>元素可以重复</td>
<td>元素不能重复</td>
</tr>
<tr>
<td>元素是有顺序的</td>
<td>元素没有顺序</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><ol>
<li><p>HashMap的默认初始容量为什么是16？</p>
<p>jdk中没有明确解释。估计：太小可能会引起扩容，太大可能空间浪费严重；</p>
</li>
<li><p>HassHap为什么扩容因子是0.75</p>
<p>因为要是使用0.5的话，空间浪费严重；要是大于0.75的话，hash冲突会更严重</p>
</li>
<li><p>HashMap中的计算hashcode方法</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//1.key 为null的话，放在数组中的第1个</span>
<span class="token comment">//2.(h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); hashcode的高16为参与hash运算，为了使hashcode的结果更加三列，避免hash冲突</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>HashMap如何计算初始容量（2的N次方）</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315100015.png" alt="image-20210315100009332"></p>
<p>扩容后元素如何计算在数组中的下标</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315104431.png" alt="image-20210315104431130"></p>
<h4 id="jdk1-8中的HashMap"><a href="#jdk1-8中的HashMap" class="headerlink" title="jdk1.8中的HashMap"></a>jdk1.8中的HashMap</h4><h5 id="hashMap的数据结构"><a href="#hashMap的数据结构" class="headerlink" title="hashMap的数据结构"></a>hashMap的数据结构</h5><ul>
<li>key是不能重复的</li>
<li>key是可以为null的</li>
<li>hashmap的初始容量是2的N次方</li>
</ul>
<p>jdk1.8中hashmap的数据结构是数组+链表+红黑树</p>
<ul>
<li>初始容量（数组的长度）</li>
<li>负载因子：数组中的元素个数占数组长度的百分比如果超过负载因子，就扩容</li>
<li>链表转红黑树的临界值：8</li>
<li>红黑树转回链表的临界值：6</li>
</ul>
<p><strong>链表转为红黑树的条件：</strong></p>
<p>数组长度大于等于64</p>
<p>链表长度大于等于8</p>
<p><strong>红黑树转回链表：</strong></p>
<p>红黑树元素个数长度小于等于6</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226154542.png" alt="image-20210226154542486"></p>
<h6 id="hashmap在调⽤put（key）时候的详细步骤："><a href="#hashmap在调⽤put（key）时候的详细步骤：" class="headerlink" title="hashmap在调⽤put（key）时候的详细步骤："></a>hashmap在调⽤put（key）时候的详细步骤：</h6><ol>
<li><p>计算key的hashcode。为什么高16位要参与计算hashcode呢？为了让hash结果更加散列（(key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16)）</p>
</li>
<li><p>根据hashcode对数组长度取余数（使用位移运算），得到的结果就是元素在数组中的位置</p>
</li>
<li><p>如果数组在对应的位置上已经有元素了</p>
<p>3.1如果是链表，那么遍历链表，根据key的hashcode和key.equals()来查找是否存在，如果存在，则覆盖，如果不存在则添加</p>
<p>3.2如果是红黑树，同样根据key的hashcode和key.equals()遍历，如果存在，则覆盖，如果不存在，则添加</p>
</li>
<li><p>如果数组对应位置上没有元素，则添加</p>
</li>
<li><p>检查是否元素个数大于扩容阈值，如果大于，则执行扩容操作</p>
</li>
</ol>
<h6 id="hashmap在调用get（key）时候的详细步骤："><a href="#hashmap在调用get（key）时候的详细步骤：" class="headerlink" title="hashmap在调用get（key）时候的详细步骤："></a>hashmap在调用get（key）时候的详细步骤：</h6><ol>
<li>计算key的hashcode</li>
<li>根据hashcode对数组长度取余数，得到的结果就是元素在数组中的位置</li>
<li>如果对应的数组位置上是链表，则遍历链表，根据hashcode和equals决定是否集合中的元素是要查找的，找到则返回，找不到，返回null</li>
<li>如果数组的对应位置是红黑树，则遍历红黑树，根据hashcode和equals决定是否集合中的元素是要查找的，找到则返回，找不到，返回null</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wfq9330/p/9023892.html">并发HashMap的put操作引起死循环 - 爱养花的码农 - 博客园 (cnblogs.com)</a></p>
<h6 id="hashMap的扩容机制是什么"><a href="#hashMap的扩容机制是什么" class="headerlink" title="hashMap的扩容机制是什么"></a>hashMap的扩容机制是什么</h6><p>扩容后的数组长度是原来的2倍</p>
<h6 id="生成链表"><a href="#生成链表" class="headerlink" title="生成链表"></a>生成链表</h6><p>hashmap在向链表添加元素的时候，是在尾部添加的。</p>
<h4 id="jdk1-7中的HashMap"><a href="#jdk1-7中的HashMap" class="headerlink" title="jdk1.7中的HashMap"></a>jdk1.7中的HashMap</h4><h5 id="hashMap的数据结构-1"><a href="#hashMap的数据结构-1" class="headerlink" title="hashMap的数据结构"></a>hashMap的数据结构</h5><ul>
<li>key是不能重复的</li>
<li>key是可以为null的</li>
<li>hashmap的初始容量是2的N次方</li>
</ul>
<p>jdk1.7中hashmap的数据结构是数组+链表</p>
<ul>
<li>初始容量（数组的长度）</li>
<li>负载因子：数组中的元素个数占数组长度的百分比如果超过负载因子，就扩容</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210227142349.png" alt="image-20210227142343419"></p>
<h6 id="hashmap在调⽤put（key）时候的详细步骤：-1"><a href="#hashmap在调⽤put（key）时候的详细步骤：-1" class="headerlink" title="hashmap在调⽤put（key）时候的详细步骤："></a>hashmap在调⽤put（key）时候的详细步骤：</h6><ol>
<li><p>计算key的hashcode</p>
</li>
<li><p>根据hashcode对数组长度取余数，得到的结果就是元素在数组中的位置</p>
</li>
<li><p>如果数组在对应的位置上已经有元素了</p>
<p>3.1如果是链表，那么遍历链表，根据key的hashcode和key.equals()来查找是否存在，如果存在，则覆盖，如果不存在则添加</p>
</li>
<li><p>如果数组对应位置上没有元素，则添加</p>
</li>
</ol>
<h6 id="hashmap在调用get（key）时候的详细步骤：-1"><a href="#hashmap在调用get（key）时候的详细步骤：-1" class="headerlink" title="hashmap在调用get（key）时候的详细步骤："></a>hashmap在调用get（key）时候的详细步骤：</h6><ol>
<li>计算key的hashcode</li>
<li>根据hashcode对数组长度取余数，得到的结果就是元素在数组中的位置</li>
<li>如果对应的数组位置上是链表，则遍历链表，根据hashcode和equals决定是否集合中的元素是要查找的，找到则返回，找不到，返回null</li>
</ol>
<h6 id="hashMap的扩容机制是什么-1"><a href="#hashMap的扩容机制是什么-1" class="headerlink" title="hashMap的扩容机制是什么"></a>hashMap的扩容机制是什么</h6><p>扩容后的数组长度是原来的2倍</p>
<h6 id="生成链表-1"><a href="#生成链表-1" class="headerlink" title="生成链表"></a>生成链表</h6><p>hashmap在向链表添加元素的时候，是在头部添加的。<strong>在多线程环境中，扩容的时候可能会产生死循环</strong></p>
<h3 id="1-7中的ConcurrentHashMap"><a href="#1-7中的ConcurrentHashMap" class="headerlink" title="1.7中的ConcurrentHashMap"></a>1.7中的ConcurrentHashMap</h3><p>采用分段式锁,锁在segment上</p>
<h3 id="jdk1-8中的ConcurrentHashMap"><a href="#jdk1-8中的ConcurrentHashMap" class="headerlink" title="jdk1.8中的ConcurrentHashMap"></a>jdk1.8中的ConcurrentHashMap</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44613591/article/details/109251515">https://blog.csdn.net/qq_44613591/article/details/109251515</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42092787/article/details/109027535">https://blog.csdn.net/weixin_42092787/article/details/109027535</a></p>
<p>使用CAS保证并发安全</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210227144920.png" alt="image-20210227144920570"></p>
<h3 id="hashtable的为什么并发度低"><a href="#hashtable的为什么并发度低" class="headerlink" title="hashtable的为什么并发度低"></a>hashtable的为什么并发度低</h3><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210227143449.png" alt="image-20210227143449632"></p>
<h5 id="如何遍历HashMap"><a href="#如何遍历HashMap" class="headerlink" title="如何遍历HashMap"></a>如何遍历HashMap</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"aa"</span><span class="token punctuation">,</span><span class="token string">"avalue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"bb"</span><span class="token punctuation">,</span><span class="token string">"bvalue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> key <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> value <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="重写equals为什么需要重写hashcode⽅法"><a href="#重写equals为什么需要重写hashcode⽅法" class="headerlink" title="重写equals为什么需要重写hashcode⽅法"></a>重写equals为什么需要重写hashcode⽅法</h5><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225114421.png" alt="image-20210225114421141"></p>
<p><strong>在Java中的一些容器中，不允许有两个完全相同的对象</strong>，<strong>插入的时候，如果判断相同则会进行覆盖</strong>。这时候如果只重写了equals（）的方法，而不重写hashcode的方法，Object中hashcode是根据对象的存储地址转换而形成的一个哈希值。这时候就有可能因为没有重写hashcode方法，造成相同的对象散列到不同的位置而造成对象的不能覆盖的问题。</p>
<p>1.8中的concurrentHashMap</p>
<p>如果Map myMap = new ConcurrentHashMap(16),真正初始化容量是32，如果new ConcurrentHashMap(9)的话，那么初始化容量是16</p>
<p>key和value都不能为null，否则抛异常</p>
<p>扩容的时候，是多线程一起参与扩容</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210510152945.png" alt="image-20210510152944954"></p>
<p>计算size的方式不同：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210510152855.png" alt="image-20210510152848678"></p>
<p>sizeCtl ：默认为0，用来控制table的初始化和扩容操作<br>-1 代表table正在初始化<br>-N 表示有N-1个线程正在进行扩容操作<br>其余情况：<br>1、如果table未初始化，表示table需要初始化的大小。<br>2、如果table初始化完成，表示table的容量，默认是table大小的0.75倍</p>
<p><strong>-N 表示有N-1个线程正在进行扩容操作</strong>，这句话是错误的。</p>
<p>这里-N的定义是有问题的，应该<strong>取-N对应的二进制的低16位数值为M，此时有M-1个线程进行扩容。</strong></p>
<h3 id="有哪些集合类是线程安全的"><a href="#有哪些集合类是线程安全的" class="headerlink" title="有哪些集合类是线程安全的"></a>有哪些集合类是线程安全的</h3><table>
<thead>
<tr>
<th>线程安全</th>
<th>线程不安全</th>
</tr>
</thead>
<tbody><tr>
<td>Hashtable，ConcurrentHashMap</td>
<td>Hashmap</td>
</tr>
<tr>
<td>Vector，Stack，CopyOnWriteArrayList</td>
<td>Arraylist</td>
</tr>
</tbody></table>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//使用如下方法可以把线程不安全的类转换成线程安全的</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> threadSafeList <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedList</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h3 id="HashSet和HashMap的区别"><a href="#HashSet和HashMap的区别" class="headerlink" title="HashSet和HashMap的区别"></a>HashSet和HashMap的区别</h3><p>hashset内部使用hashmap实现的，只是用了hashmap的key</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//hashset 的add方法</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> PRESENT<span class="token punctuation">)</span><span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="06-算法"><a href="#06-算法" class="headerlink" title="06.算法"></a>06.算法</h1><p><strong>三种常用的限流算法</strong></p>
<p><strong>1、计数器算法</strong></p>
<p>2、<strong>滑动窗口</strong></p>
<p>3、<strong>令牌桶算法</strong></p>
<p>4、<strong>漏桶算法</strong></p>
<p><strong>快速排序</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/shujuelin/article/details/82423852">https://blog.csdn.net/shujuelin/article/details/82423852</a></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuickSort</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">quickSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span><span class="token keyword">int</span> low<span class="token punctuation">,</span><span class="token keyword">int</span> high<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>t<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>low<span class="token operator">&gt;</span>high<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">=</span>low<span class="token punctuation">;</span>
        j<span class="token operator">=</span>high<span class="token punctuation">;</span>
        <span class="token comment">//temp就是基准位</span>
        temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>low<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
        <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//先看右边，依次往左递减</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token operator">&lt;=</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                j<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//再看左边，依次往右递增</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>temp<span class="token operator">&gt;=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                i<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//如果满足条件则交换</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                t <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
 
        <span class="token punctuation">}</span>
        <span class="token comment">//最后将基准为与i和j相等位置的数字交换</span>
         arr<span class="token punctuation">[</span>low<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
         arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
        <span class="token comment">//递归调用左半数组</span>
        <span class="token function">quickSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> low<span class="token punctuation">,</span> j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//递归调用右半数组</span>
        <span class="token function">quickSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">quickSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arr<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>冒泡排序</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
	 * 普通int数组从小到大排序
	 * @param arr
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">int</span> length <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
		<span class="token keyword">boolean</span> sorted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//循环次数  每完成一次  沉入底部一个数</span>
			sorted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//每一次开始  默认已经排好序</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>j<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> arr<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">int</span> temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
					arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
					arr<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
					sorted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//还没有排好序</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>sorted<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//确实已经排好序了</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">//不再继续循环</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">sort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arr<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>二叉树</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BinaryTree</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">TreeNode</span>  root <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	
	<span class="token keyword">public</span> <span class="token class-name">BinaryTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TreeNode</span><span class="token punctuation">{</span>
		<span class="token keyword">private</span> <span class="token keyword">int</span> index<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token class-name">String</span> data<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token class-name">TreeNode</span> leftChild<span class="token punctuation">;</span>
		<span class="token keyword">private</span> <span class="token class-name">TreeNode</span> rightChild<span class="token punctuation">;</span>
		
	
		<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> index<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setIndex</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> index<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> data<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setData</span><span class="token punctuation">(</span><span class="token class-name">String</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		<span class="token keyword">public</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span><span class="token class-name">String</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> index<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>leftChild <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>rightChild <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">/**
	 * 构建二叉树
	 *         A
	 *     B       C
	 * D      E        F
	 
	 
	 A B D C F E
	 
	getHeight(A)
		i = getHeight(B) 2
			i1 = getHeight(D) 1     
				i2 = getHeight(null)  0
				j2 = getHeight(null)  0
			j1 = getHeight(E)  1
			
		j = getHeight(C)
	
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createBinaryTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">TreeNode</span> nodeB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">TreeNode</span> nodeC <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">TreeNode</span> nodeD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">TreeNode</span> nodeE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"E"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">TreeNode</span> nodeF <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		root<span class="token punctuation">.</span>leftChild <span class="token operator">=</span> nodeB<span class="token punctuation">;</span>
		root<span class="token punctuation">.</span>rightChild <span class="token operator">=</span> nodeC<span class="token punctuation">;</span>
		nodeB<span class="token punctuation">.</span>leftChild <span class="token operator">=</span> nodeD<span class="token punctuation">;</span>
		nodeB<span class="token punctuation">.</span>rightChild <span class="token operator">=</span> nodeE<span class="token punctuation">;</span>
		nodeC<span class="token punctuation">.</span>rightChild <span class="token operator">=</span> nodeF<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">/**
	 * 求二叉树的高度
	 * @author smallkong
	 *
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">getHeight</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">getHeight</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>leftChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token function">getHeight</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>rightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span><span class="token operator">?</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * 获取二叉树的结点数
	 * @author smallkong
	 *
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">getSize</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token number">1</span><span class="token operator">+</span><span class="token function">getSize</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>leftChild<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">getSize</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>rightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * 前序遍历——递归
	 * @author smallkong
	 *
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">preOrder</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">preOrder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>leftChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">preOrder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>rightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">/**
	 * 前序遍历——非递归
	 */</span>
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nonRecOrder</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">Stack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//出栈和进栈</span>
			<span class="token class-name">TreeNode</span> n <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//弹出根结点</span>
			<span class="token comment">//压入子结点</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>rightChild<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>rightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
				
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leftChild<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>n<span class="token punctuation">.</span>leftChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">/**
	 * 中序遍历——递归
	 * @author smallkong
	 *
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">midOrder</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token function">midOrder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>leftChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">midOrder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>rightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">/**
	 * 后序遍历——递归
	 * @author smallkong
	 *
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postOrder</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token function">postOrder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>leftChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">postOrder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>rightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">BinaryTree</span> binaryTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BinaryTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binaryTree<span class="token punctuation">.</span><span class="token function">createBinaryTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">int</span> height <span class="token operator">=</span> binaryTree<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"树的高度treeHeihgt:"</span><span class="token operator">+</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">int</span> size <span class="token operator">=</span> binaryTree<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"结点数treeSize:"</span><span class="token operator">+</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"前序preOrder data:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binaryTree<span class="token punctuation">.</span><span class="token function">preOrder</span><span class="token punctuation">(</span>binaryTree<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n中序midOrder data:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binaryTree<span class="token punctuation">.</span><span class="token function">midOrder</span><span class="token punctuation">(</span>binaryTree<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n后序postOrder data:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binaryTree<span class="token punctuation">.</span><span class="token function">postOrder</span><span class="token punctuation">(</span>binaryTree<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n前序非递归preOrder data:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		binaryTree<span class="token punctuation">.</span><span class="token function">nonRecOrder</span><span class="token punctuation">(</span>binaryTree<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lanhaicode/p/10390147.html">二叉树的遍历（前序、中序、后序、已知前中序求后序、已知中后序求前序） - 蓝海人 - 博客园 (cnblogs.com)</a></p>
<h2 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h2><p>DES</p>
<h2 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h2><p>RSA，SHA256</p>
<p><a target="_blank" rel="noopener" href="https://www.php.cn/faq/465668.html">对称加密与非对称加密的区别是什么-常见问题-PHP中文网</a></p>
<p><a target="_blank" rel="noopener" href="http://www.360doc.com/content/16/1010/15/9462341_597351504.shtml">常用加密算法的Java实现总结(一) (360doc.com)</a></p>
<p><a target="_blank" rel="noopener" href="http://www.blogjava.net/amigoxie/archive/2014/07/06/415503.html">常用加密算法的Java实现总结(二)——对称加密算法DES、3DES和AES - 阿蜜果 - BlogJava</a></p>
<h2 id="雪花算法"><a href="#雪花算法" class="headerlink" title="雪花算法"></a>雪花算法</h2><p>SnowFlake算法生成id的结果是一个64bit大小的整数，它的结构如下图：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226142634.png" alt="image-20210226142634685"></p>
<p><strong>● 1位，不用。二进制中最高位为1的都是负数，但是我们生成的id一般都使用整数，所以这个最高位固定是0</strong></p>
<p><strong>● 41位，用来记录时间戳（毫秒）。</strong><br>     ○ 41位可以表示$2^{41}-1$个数字，<br>     ○ 如果只用来表示正整数（计算机中正数包含0），可以表示的数值范围是：0 至 $2^{41}-1$，减1是因为可表示的数值范围是从0开始算的，而不是1。<br>     ○ 也就是说41位可以表示$2^{41}-1$个毫秒的值，转化成单位年则是$(2^{41}-1) / (1000 * 60 * 60 * 24 * 365) = 69$年</p>
<p>● <strong>10位，用来记录工作机器id。</strong><br>     ○ 可以部署在$2^{10} = 1024$个节点，包括 5位datacenterId 和 5位workerId<br>     ○ 5位（bit）可以表示的最大正整数是$2^{5}-1 = 31$，即可以用0、1、2、3、….31这32个数字，来表示不同的datecenterId或workerId</p>
<p>● <strong>12位，序列号，用来记录同毫秒内产生的不同id。</strong><br>     ○ 12位（bit）可以表示的最大正整数是$2^{12}-1 = 4095$，即可以用0、1、2、3、….4094这4095个数字，来表示同一机器同一时间截（毫秒)内产生的4095个ID序号</p>
<p><strong>由于在Java中64bit的整数是long类型，所以在Java中SnowFlake算法生成的id就是long来存储的。</strong></p>
<p><strong>SnowFlake可以保证：</strong><br>    ● 所有生成的id按时间趋势递增<br>    ● 整个分布式系统内不会产生重复id（因为有datacenterId和workerId来做区分）</p>
<h1 id="07-多线程"><a href="#07-多线程" class="headerlink" title="07.多线程"></a>07.多线程</h1><h2 id="创建线程的方法"><a href="#创建线程的方法" class="headerlink" title="创建线程的方法"></a>创建线程的方法</h2><ul>
<li>继承Thread类</li>
<li>实现Runnable接口</li>
<li>实现Callable接口</li>
</ul>
<h2 id="如何实现线程安全"><a href="#如何实现线程安全" class="headerlink" title="如何实现线程安全"></a>如何实现线程安全</h2><h4 id="synchronized（可重入锁，非公平锁）"><a href="#synchronized（可重入锁，非公平锁）" class="headerlink" title="synchronized（可重入锁，非公平锁）"></a>synchronized（可重入锁，非公平锁）</h4><ul>
<li>偏向锁</li>
<li>轻量级锁（自旋锁CAS）</li>
<li>重量级锁（依赖操作系统实现） monitorenter/monitorexit（jdk1.6之前直接使用这个锁，jdk1.6之后，引入了锁升级的过程）</li>
</ul>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> threadSafeList <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedList</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Test</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        test<span class="token punctuation">.</span><span class="token function">m3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">static</span><span class="token punctuation">{</span>
        <span class="token comment">//锁在类对象上Test.class</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Test</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//静态方法的锁是在类对象的Test.class</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span>  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">m1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//普通方法的锁是在实例对象上也就是main方法中的test对象</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">m3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">//没有synchronized修饰的普通方法，和有synchronized修饰的普通方法不会有锁竞争关系，</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">m4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">m5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//锁在实例对象上：test对象</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h2><p>需要自己使用lock.unlock()释放锁，要放在finally块中。Lock是用CAS来实现的</p>
<ul>
<li>ReentranceLock（可重入锁）</li>
<li>CyclicBarrier</li>
</ul>
<h2 id="synchronizedLock对⽐"><a href="#synchronizedLock对⽐" class="headerlink" title="synchronizedLock对⽐"></a>synchronizedLock对⽐</h2><p>在多线程环境并存在大量竞争的情况下，synchronized的用时效率下降严重，而lock却依然保存不变或增加很少。</p>
<p>1.6以上synchronized也改用CAS来实现了，所以两者性能差不多<br>Lock提供的功能丰富点，synchronized的使用简单点</p>
<p>synchronized是不能设置超时时间的，只能等待</p>
<p>Lock是可以设置超时时间，lock.tryLock(4000,TimeUnit.SECONDS) 超时后，直接返回false,如果获取锁成功，返回true</p>
<p>synchronized 可以自动释放锁</p>
<p>Lock要自己手动释放，需要在finally语句块中执行lock.unlock()操作</p>
<h2 id="synchronized和volatile的区别"><a href="#synchronized和volatile的区别" class="headerlink" title="synchronized和volatile的区别"></a>synchronized和volatile的区别</h2><p>volatile的特点：</p>
<ul>
<li>内存可见性</li>
<li>防止指令重排序</li>
<li>不能保证原子性</li>
</ul>
<p>synchronized包括内存可见性，防止指令重拍，能够保证原子性</p>
<h2 id="你知道CAS是什么吗？为什么要采⽤这种算法？"><a href="#你知道CAS是什么吗？为什么要采⽤这种算法？" class="headerlink" title="你知道CAS是什么吗？为什么要采⽤这种算法？"></a>你知道CAS是什么吗？为什么要采⽤这种算法？</h2><p>CAS,compare and swap的缩写，中文翻译成比较并交换.</p>
<p><strong>注意：CAS依赖计算机底层硬件的锁实现的。效率比较高。</strong></p>
<p>CAS机制当中使用了3个基本操作数：内存地址V，旧的预期值expect，要修改的新值update。如果内存V中的值是expect，那么修改成功，否则，修改就失败了。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> expect<span class="token punctuation">,</span> <span class="token keyword">int</span> update<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> unsafe<span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> valueOffset<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>CAS的缺点：</p>
<p>1.CPU开销较大<br> 在并发量比较高的情况下，如果许多线程反复尝试更新某一个变量，却又一直更新不成功，循环往复，会给CPU带来很大的压力。</p>
<p>2.不能保证代码块的原子性<br> CAS机制所保证的只是一个变量的原子性操作，而不能保证整个代码块的原子性。比如需要保证3个变量共同进行原子性的更新，就不得不使用Synchronized了。</p>
<h2 id="线程同步的⽅法有哪些"><a href="#线程同步的⽅法有哪些" class="headerlink" title="线程同步的⽅法有哪些"></a>线程同步的⽅法有哪些</h2><ul>
<li>通过Object的wait和notify 、notifyAll</li>
<li>通过Condition的await和signal（配合Lock使用） </li>
<li>通过同步辅助类CountDownLatch </li>
<li>通过同步辅助类CyclicBarrier</li>
<li>通过阻塞队列 LinkedBlockingQueue</li>
</ul>
<h2 id="用过哪些线程池"><a href="#用过哪些线程池" class="headerlink" title="用过哪些线程池"></a>用过哪些线程池</h2><p>ThreadPoolExecutor</p>
<p>7个参数</p>
<pre class="line-numbers language-none"><code class="language-none">int corePoolSize,---核心线程数 比如：3
int maximumPoolSize,--最大线程数 比如：10
long keepAliveTime,--空闲线程的存活时间
TimeUnit unit,--时间单位
BlockingQueue&lt;Runnable&gt; workQueue,--阻塞队列
ThreadFactory threadFactory,--线程工厂
RejectedExecutionHandler handler--拒绝策略<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>线程池启动后，没有线程活动</p>
<p>当添加任务到线程池，没有活动线程，则创建一个线程执行任务，并且没有达到核心线程数，那就创建新的线程</p>
<p>如果已经达到核心线程数，那么任务会放在阻塞队列；</p>
<p>如果阻塞队列满了，没有达到最大线程数，那么创建新的线程</p>
<p>如果已经达到最大线程数，触发拒绝策略</p>
<p>顺序：coreSize–&gt;workQueue—&gt;maximumPoolSize</p>
<p>默认的拒绝策略：</p>
<pre class="line-numbers language-none"><code class="language-none">AbortPolicy --- 拒绝并抛出异常（默认）
DiscardPolicy---直接抛弃任务，不抛异常
DiscardOldestPolicy--抛弃等待最久的任务
CallerRunsPolicy--调用者线程自己处理<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="线程有哪些状态"><a href="#线程有哪些状态" class="headerlink" title="线程有哪些状态"></a>线程有哪些状态</h2><ul>
<li>初始状态 Thread t=new Thread()</li>
<li>可运行状态 t.start()</li>
<li>运行状态</li>
<li>阻塞状态</li>
<li>死亡状态</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224170043.png" alt="image-20210224170042946"></p>
<h2 id="wait和sleep的区别"><a href="#wait和sleep的区别" class="headerlink" title="wait和sleep的区别"></a>wait和sleep的区别</h2><ul>
<li>sleep()方法是Thread类的静态方法，不会释放锁</li>
<li>wait()是Object类的方法，会释放锁</li>
</ul>
<h2 id="callable-返回值-⽤什么接收"><a href="#callable-返回值-⽤什么接收" class="headerlink" title="callable 返回值 ⽤什么接收"></a>callable 返回值 ⽤什么接收</h2><p>使用Future接收</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test3</span> <span class="token punctuation">{</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ThreadPoolExecutor</span> memberPoolExecutor <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> memberPoolExecutor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
                <span class="token comment">//执行逻辑</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token string">"返回String"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//这个方法是一个阻塞的方法</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"主线程。。。。。。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="线程池的几种创建方式"><a href="#线程池的几种创建方式" class="headerlink" title="线程池的几种创建方式"></a>线程池的几种创建方式</h2><ul>
<li><p>newFixedThreadPool：定长线程池，每当提交一个任务就创建一个线程，直到达到线程池的最大数量，这时线程数量不再变化，当线程发生错误结束时，线程池会补充一个新的线程</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> fixedExecutor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>newCachedThreadPool:可缓存的线程池，如果线程池的容量超过了任务数，自动回收空闲线程，任务增加时可以自动添加新线程，线程池的容量不限制</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> cachedExecutor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>newScheduledThreadPool:定长线程池，可执行周期性的任务</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ScheduledExecutorService</span> scheduledExecutor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>newSingleThreadExecutor:单线程的线程池，线程异常结束，会创建一个新的线程，能确保任务按提交顺序执行</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> singleExecutor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h2 id="说一下JUC的包中你知道的控制线程并发两个的类，分别在什么情况下使用"><a href="#说一下JUC的包中你知道的控制线程并发两个的类，分别在什么情况下使用" class="headerlink" title="说一下JUC的包中你知道的控制线程并发两个的类，分别在什么情况下使用"></a>说一下JUC的包中你知道的控制线程并发两个的类，分别在什么情况下使用</h2><h4 id="CountDownLatch，多个子线程都执行完毕后，再执行主线程"><a href="#CountDownLatch，多个子线程都执行完毕后，再执行主线程" class="headerlink" title="CountDownLatch，多个子线程都执行完毕后，再执行主线程"></a>CountDownLatch，多个子线程都执行完毕后，再执行主线程</h4><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210315164037433.png" alt="image-20210315164037433"></p>
<p>CyclicBarrier：子线程之间相互等待，大家都准备好后，一起执行</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315164855.png" alt="image-20210315164855527"></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CyclicBarrier</span> cyclicBarrier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CyclicBarrier</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cyclicBarrier<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">":结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cyclicBarrier<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">":结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread</span> t3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cyclicBarrier<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">":结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"主线程结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="为什么会产生死锁？如何避免"><a href="#为什么会产生死锁？如何避免" class="headerlink" title="为什么会产生死锁？如何避免"></a>为什么会产生死锁？如何避免</h2><h5 id="死锁：两个线程互相等待对方释放锁住的资源，但是自己却不释放资源给对方。"><a href="#死锁：两个线程互相等待对方释放锁住的资源，但是自己却不释放资源给对方。" class="headerlink" title="死锁：两个线程互相等待对方释放锁住的资源，但是自己却不释放资源给对方。"></a>死锁：两个线程互相等待对方释放锁住的资源，但是自己却不释放资源给对方。</h5><p>死锁产生的四个条件：</p>
<ul>
<li>互斥条件：进程要求对所分配的资源进行排它性控制，即在一段时间内某资源仅为一进程所占用。</li>
<li>请求和保持条件：当进程因请求资源而阻塞时，对已获得的资源保持不放。</li>
<li>不剥夺条件：进程已获得的资源在未使用完之前，不能剥夺，只能在使用完时由自己释放。</li>
<li>环路等待条件：在发生死锁时，必然存在一个进程–资源的环形链。</li>
</ul>
<p>预防死锁：</p>
<ul>
<li>资源一次性分配：一次性分配所有资源，这样就不会再有请求了：（破坏请求条件）</li>
<li>只要有一个资源得不到分配，也不给这个进程分配其他的资源：（破坏请保持条件）</li>
<li>可剥夺资源：即当某进程获得了部分资源，但得不到其它资源，则释放已占有的资源（破坏不可剥夺条件）<br>资源有序分配法：系统给每类资源赋予一个编号，每一个进程按编号递增的顺序请求资源，释放则相反（破坏环路等待条件）</li>
</ul>
<p>死锁代码：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> obj1 <span class="token operator">=</span> <span class="token string">"obj1"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> obj2 <span class="token operator">=</span> <span class="token string">"obj2"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Lock1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Lock2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        b<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Lock1</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span><span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock1 running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">DeadLock</span><span class="token punctuation">.</span>obj1<span class="token punctuation">)</span><span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock1 lock obj1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取obj1后先等一会儿，让Lock2有足够的时间锁住obj2</span>
                        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">DeadLock</span><span class="token punctuation">.</span>obj2<span class="token punctuation">)</span><span class="token punctuation">{</span>
                                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock1 lock obj2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Lock2</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span><span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock2 running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">DeadLock</span><span class="token punctuation">.</span>obj2<span class="token punctuation">)</span><span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock2 lock obj2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">DeadLock</span><span class="token punctuation">.</span>obj1<span class="token punctuation">)</span><span class="token punctuation">{</span>
                            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lock2 lock obj1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="08-JVM"><a href="#08-JVM" class="headerlink" title="08.JVM"></a>08.JVM</h1><h2 id="JVM内存的结构"><a href="#JVM内存的结构" class="headerlink" title="JVM内存的结构"></a>JVM内存的结构</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225113559.png" alt="image-20210225113558946"></p>
<ul>
<li>程序计数器：保存cpu下一条指令的地址</li>
<li>堆：对象实例分配空间的地方</li>
<li>方法区：类信息，字段信息，常量池，方法信息，类变量，classloader引用，Class对象的引用</li>
<li>虚拟机栈：方法运行时候保存信息的地方</li>
<li>本地方法栈：本地方法运行时保存信息的地方。</li>
</ul>
<h2 id="为什么新⽣代要有两个s区呢"><a href="#为什么新⽣代要有两个s区呢" class="headerlink" title="为什么新⽣代要有两个s区呢"></a>为什么新⽣代要有两个s区呢</h2><p>因为新生代采用了标记复制算法做垃圾回收，所以需要两个一样的大的区域，相互复制对象。</p>
<h2 id="手动触发垃圾回收"><a href="#手动触发垃圾回收" class="headerlink" title="手动触发垃圾回收"></a>手动触发垃圾回收</h2><p>JAVA的垃圾回收，在程序中，会⼈为写⼀些代码，当程序执⾏到这⾥的时候会直接进⾏垃圾回收，如 </p>
<p>果有，这个代码是什么</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="JVM的分代回收机制"><a href="#JVM的分代回收机制" class="headerlink" title="JVM的分代回收机制"></a>JVM的分代回收机制</h2><ul>
<li>对于新生代采用标记复制算法</li>
<li>对于老年代采用标记清理 或  标记整理算法回收</li>
</ul>
<p>说明：当前商业虚拟机的垃圾收集都采用“分代收集”（Generational Collection）算法，根据对象存活周期的不同将内存划分为几块并采用不用的垃圾收集算法。</p>
<p>一般是把 Java 堆分为新生代和老年代，这样就可以根据各个年代的特点采用最适当的收集算法。在新生代中，每次垃圾收集时都发现有大批对象死去，只有少量存活，那就选用复制算法，只需要付出少量存活对象的复制成本就可以完成收集。而老年代中因为对象存活率高、没有额外空间对它进行分配担保，就必须使用“标记—清理”或者“标记—整理”算法来进行回收。</p>
<h2 id="对象从新⽣代到⽼⽣代的触发机制"><a href="#对象从新⽣代到⽼⽣代的触发机制" class="headerlink" title="对象从新⽣代到⽼⽣代的触发机制"></a>对象从新⽣代到⽼⽣代的触发机制</h2><p>在新生代中，每做一次young GC，对象的年龄加1（对象头中有个标志位记录）当这个对象年龄达到15岁的时候，就进入老年代</p>
<h1 id="09-Linux"><a href="#09-Linux" class="headerlink" title="09.Linux"></a>09.Linux</h1><p>cp复制</p>
<p>mv移动</p>
<p>ls 查看目录中的内容</p>
<p>ll查看目录中的内容</p>
<p>chmod 修改文件或目录的权限</p>
<p>chown 修改文件或目录的所有者</p>
<p>ps 查看系统中有哪些进程</p>
<p>netstat 查看系统中进程占用的端口</p>
<p>rm 删除文件或目录</p>
<p>cd进入一个目录</p>
<p>cat 、 more 查看文件内容</p>
<p>vim、vi 编辑一个文件</p>
<p>top查看系统中资源占用情况</p>
<p>clear清除屏幕</p>
<h1 id="10-NGINX"><a href="#10-NGINX" class="headerlink" title="10.NGINX"></a>10.NGINX</h1><h2 id="NGINX配置负载均衡配置⽂件-怎么写的"><a href="#NGINX配置负载均衡配置⽂件-怎么写的" class="headerlink" title="NGINX配置负载均衡配置⽂件 怎么写的"></a>NGINX配置负载均衡配置⽂件 怎么写的</h2><pre class="line-numbers language-none"><code class="language-none">   upstream loadbalance { 
     server 127.0.0.1:8081 weight=1; 
     server 127.0.0.1:8082 weight=1; 
     server 127.0.0.1:8080 weight=1;
   }

server {
	listen       80; #请求的端口
	server_name  demo.loadbalance.com; #请求的域名

	proxy_set_header X-Forwarded-Host $host;
	proxy_set_header X-Forwarded-Server $host;
	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		
	location / {
           root   html;
           index  index.html index.htm;
           proxy_pass   http://loadbalance; #把请求转发到上面配置的upstream loadbalance
	}			


}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="11-网络协议"><a href="#11-网络协议" class="headerlink" title="11.网络协议"></a>11.网络协议</h1><h2 id="说一下-TCP-粘包拆包是怎么产生的"><a href="#说一下-TCP-粘包拆包是怎么产生的" class="headerlink" title="说一下 TCP 粘包拆包是怎么产生的"></a>说一下 TCP 粘包拆包是怎么产生的</h2><h5 id="粘包：接收方的缓冲区缓存了多个请求的报文，就是粘包"><a href="#粘包：接收方的缓冲区缓存了多个请求的报文，就是粘包" class="headerlink" title="粘包：接收方的缓冲区缓存了多个请求的报文，就是粘包"></a>粘包：接收方的缓冲区缓存了多个请求的报文，就是粘包</h5><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315161056.png" alt="image-20210315161056348"></p>
<h5 id="拆包：发送方需要发送的数据被迫分多次发送，这就是拆包"><a href="#拆包：发送方需要发送的数据被迫分多次发送，这就是拆包" class="headerlink" title="拆包：发送方需要发送的数据被迫分多次发送，这就是拆包"></a>拆包：发送方需要发送的数据被迫分多次发送，这就是拆包</h5><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210315161353.png" alt="image-20210315161353196"></p>
<h2 id="TCP和UDP的区别"><a href="#TCP和UDP的区别" class="headerlink" title="TCP和UDP的区别"></a>TCP和UDP的区别</h2><ul>
<li>首先TCP是面向连接的，UDP是无需连接的，TCP有着三握四挥</li>
<li>TCP保证可靠传输，UDP不保证可靠传输</li>
<li>TCP是有拥塞控制的，但是UDP没有</li>
</ul>
<h2 id="TCP的三次握手"><a href="#TCP的三次握手" class="headerlink" title="TCP的三次握手"></a>TCP的三次握手</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45393094/article/details/104965561?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param">https://blog.csdn.net/weixin_45393094/article/details/104965561?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param</a></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225173743.png" alt="image-20210225173743210"></p>
<p>客户端发起请求：SYN=1，seq=1000（随机数）</p>
<p>服务端响应：ACK=1001，seq=2000（随机数）</p>
<p>客户端再次发起请求：ACK=2001</p>
<p>为什么不使用两次握手：</p>
<p>如果使用两次握手，当服务器响应客户端的请求后，客户端可能没有收到服务器的响应，这时候，如果服务器已经建立了Socket连接，那么是很浪费资源的。</p>
<h2 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225174709.png" alt="image-20210225174709619"></p>
<ul>
<li>服务端申请断开连接即FIN，发送Seq+Ack</li>
<li>客户端接收信息返回，表示我已经接收到</li>
<li>客户端发送信息表示可以断开连接</li>
<li>服务端接受信息，返回数据表示已接受信息</li>
</ul>
<p>为什么连接的时候是三次握手，关闭的时候却是四次握手？</p>
<ul>
<li>因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。</li>
<li>但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，要等应用程序处理完成，所以只能先回复一个ACK报文，告诉Client端，“你发的FIN报文我收到了”。</li>
<li>只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。</li>
</ul>
<h2 id="WebSocket和HTTP的区别"><a href="#WebSocket和HTTP的区别" class="headerlink" title="WebSocket和HTTP的区别"></a>WebSocket和HTTP的区别</h2><p>参考：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/113286469">https://zhuanlan.zhihu.com/p/113286469</a></p>
<table>
<thead>
<tr>
<th>比较项目</th>
<th>HTTP</th>
<th>WebSocket</th>
</tr>
</thead>
<tbody><tr>
<td>长连接</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>双向通信</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>基于TCP</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>协议</td>
<td>HTTP</td>
<td>WS</td>
</tr>
<tr>
<td>使用场景</td>
<td>不需要很频繁或仅获取一次的数据可以通过简单的<code>HTTP</code>请求查询</td>
<td>如果我们需要通过网络传输的任何实时更新或连续数据流，则可以使用<code>WebSocket</code>，例如聊天，股票行情</td>
</tr>
</tbody></table>
<h1 id="12-事务"><a href="#12-事务" class="headerlink" title="12.事务"></a>12.事务</h1><h2 id="悲观锁和乐观锁"><a href="#悲观锁和乐观锁" class="headerlink" title="悲观锁和乐观锁"></a>悲观锁和乐观锁</h2><p><strong>悲观锁</strong>认为被它保护的数据是极其不安全的，每时每刻都有可能变动，一个事务拿到悲观锁后（可以理解为一个用户），其他任何事务都不能对该数据进行修改，只能等待锁被释放才可以执行。</p>
<p><strong>乐观锁</strong>的“乐观情绪”体现在，它认为数据的变动不会太频繁。因此，它允许多个事务同时对数据进行变动。但是，乐观不代表不负责，那么怎么去负责多个事务顺序对数据进行修改呢？乐观锁通常是通过在表中增加一个版本(version)或时间戳(timestamp)来实现，其中，版本最为常用。</p>
<p>数据库实现悲观锁</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> num <span class="token keyword">from</span> goods <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">for</span> <span class="token keyword">update</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>数据库实现乐观锁：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> tb_goods <span class="token keyword">set</span> salary<span class="token operator">=</span>salary<span class="token operator">+</span><span class="token number">2000</span> <span class="token keyword">where</span> user_id<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">and</span> version<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>java代码实现悲观锁</p>
<p>synchromized</p>
<p>java代码实现乐观锁：</p>
<p>CAS</p>
<h2 id="分布式事务如何实现"><a href="#分布式事务如何实现" class="headerlink" title="分布式事务如何实现"></a>分布式事务如何实现</h2><p>使用Alibaba的Seata</p>
<p>Seata支持三种分布式事务方案AT，TCC，SAGA</p>
<p><strong>我们项目中目前使用的AT模式</strong></p>
<p>Seata的分布式事务解决方案是业务层面的解决方案，只依赖于单台数据库的事务能力。Seata框架中一个分布式事务包含3中角色：</p>
<ul>
<li><strong>Transaction Coordinator (TC)： 事务协调器，维护全局事务的运行状态，负责协调并驱动全局事务的提交或回滚。</strong></li>
<li><strong>Transaction Manager (TM)： 控制全局事务的边界，负责开启一个全局事务，并最终发起全局提交或全局回滚的决议。</strong></li>
<li><strong>Resource Manager (RM)： 控制分支事务，负责分支注册、状态汇报，并接收事务协调器的指令，驱动分支（本地）事务的提交和回滚。</strong></li>
</ul>
<p>其中，TM是一个分布式事务的发起者和终结者，TC负责维护分布式事务的运行状态，而RM则负责本地事务的运行。如下图所示：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225171414.png" alt="image-20210225171414295"></p>
<p>如何使用：</p>
<p>下载一个单独的seata服务端(Transaction Coordinator )</p>
<p>在事务发起方的方法上增加@GlobalTransactional</p>
<h1 id="13-Git"><a href="#13-Git" class="headerlink" title="13.Git"></a>13.Git</h1><p>git常用命令</p>
<p>git add .  把新的文件和目录添加到git的暂存区</p>
<p>git commit 把文件提交到本地仓库</p>
<p>git push 把本地仓库中的文件提交到远程仓库</p>
<p>git  pull从远程仓库拉取文件到本地，自动合并冲突</p>
<h1 id="14-RabbitMQ"><a href="#14-RabbitMQ" class="headerlink" title="14.RabbitMQ"></a>14.RabbitMQ</h1><h2 id="消息队列的应用场景"><a href="#消息队列的应用场景" class="headerlink" title="消息队列的应用场景"></a>消息队列的应用场景</h2><ul>
<li>流量削峰</li>
<li>异步</li>
<li>限流</li>
</ul>
<h2 id="如何保证消息不丢失"><a href="#如何保证消息不丢失" class="headerlink" title="如何保证消息不丢失"></a>如何保证消息不丢失</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210223153024.png" alt="image-20210223153023890"></p>
<h2 id="如何保证消息不重复消费"><a href="#如何保证消息不重复消费" class="headerlink" title="如何保证消息不重复消费"></a>如何保证消息不重复消费</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210223153625.png" alt="image-20210223153625017"></p>
<h2 id="如何保证消息顺序消费"><a href="#如何保证消息顺序消费" class="headerlink" title="如何保证消息顺序消费"></a>如何保证消息顺序消费</h2><p>消费者可以根据业务规则判断，哪些消息必须在前面消费，哪些必须在后面消费，比如使用<strong>状态机</strong></p>
<h2 id="一张图解决"><a href="#一张图解决" class="headerlink" title="一张图解决"></a>一张图解决</h2><ul>
<li>消息幂等性</li>
<li>消息的持久化</li>
<li>消息的顺序消费（消费者根据业务的要求，根据消息的某些状态字段检查，是否对象的前一个状态的消息被消费过，自己把消息排序）</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224174118.png" alt="image-20210224174117820"></p>
<h1 id="15-ElasticSearch（搜索引擎）"><a href="#15-ElasticSearch（搜索引擎）" class="headerlink" title="15.ElasticSearch（搜索引擎）"></a>15.ElasticSearch（搜索引擎）</h1><h2 id="倒排索引的原理"><a href="#倒排索引的原理" class="headerlink" title="倒排索引的原理"></a>倒排索引的原理</h2><ul>
<li>把用户输入的文档先分词</li>
<li>记录每个词所在的文档编号，出现的次数，出现在文档中的位置形成一个倒排索引文件。</li>
</ul>
<p>文章1的所有关键词为：[tom] [live] [guangzhou] [i] [live] [guangzhou] 　 　</p>
<p>文章2的所有关键词为：[he] [live] [shanghai]</p>
<table>
<thead>
<tr>
<th>关键词</th>
<th>文章号[出现频率]</th>
<th>出现位置</th>
</tr>
</thead>
<tbody><tr>
<td>guangzhou</td>
<td>1[2]</td>
<td>3，6</td>
</tr>
<tr>
<td>he</td>
<td>2[1]</td>
<td>1</td>
</tr>
<tr>
<td>i</td>
<td>1[1]</td>
<td>4</td>
</tr>
<tr>
<td>live</td>
<td>1[2]</td>
<td>2，5</td>
</tr>
<tr>
<td></td>
<td>2[1]</td>
<td>2</td>
</tr>
<tr>
<td>shanghai</td>
<td>2[1]</td>
<td>3</td>
</tr>
<tr>
<td>tom</td>
<td>1[1]</td>
<td>1</td>
</tr>
</tbody></table>
<h1 id="15-项目实战"><a href="#15-项目实战" class="headerlink" title="15.项目实战"></a>15.项目实战</h1><h2 id="项目中用什么查看日志"><a href="#项目中用什么查看日志" class="headerlink" title="项目中用什么查看日志"></a>项目中用什么查看日志</h2><p>springboot单体项目，一般都打印到服务器的某个目录，具体的配置信息请看下面的logback.xml</p>
<p>在linux上查询一个日志文件可以使用tail命令</p>
<p>具体方法：</p>
<pre class="line-numbers language-slell" data-language="slell"><code class="language-slell">#查看文件最后30行
tail -30f user-service.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>





<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210223151405.png" alt="image-20210223151405322"></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#查找日志文件中的某些字符串
grep 20210223-151157 user-service.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210223151538.png" alt="image-20210223151538758"></p>
<p><strong>logback.xml</strong></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">debug</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>LOG_HOME<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/home<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 控制台输出 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 按照每天生成日志文件 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>FILE<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--日志文件输出的文件名--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FileNamePattern</span><span class="token punctuation">&gt;</span></span>${LOG_HOME}/TestWeb.log.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FileNamePattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--日志文件保留天数--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MaxHistory</span><span class="token punctuation">&gt;</span></span>30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MaxHistory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--日志文件最大的大小--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>triggeringPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MaxFileSize</span><span class="token punctuation">&gt;</span></span>10MB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MaxFileSize</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>triggeringPolicy</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
 
    <span class="token comment">&lt;!-- 日志输出级别 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>微服务架构下收集日志方案：ELK+Filebeat ：</p>
<p>E代表Elasticsearch，负责保存和搜索日志</p>
<p>L代表Logstash，负责在保存到Elasticsearch之前格式化日志</p>
<p>K代表Kibana，负责显示日志信息</p>
<p>Filebeat：一个监听器，负责监听日志文件的内容变化</p>
<p>通过Kibana查询Elasticsearch的日志信息</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210223145135.png" alt="image-20210223145134984"></p>
<h2 id="项⽬中⽤哪个⽇志框架"><a href="#项⽬中⽤哪个⽇志框架" class="headerlink" title="项⽬中⽤哪个⽇志框架"></a>项⽬中⽤哪个⽇志框架</h2><p>LogBack</p>
<h2 id="说一下你们日常的工作流程"><a href="#说一下你们日常的工作流程" class="headerlink" title="说一下你们日常的工作流程"></a>说一下你们日常的工作流程</h2><h2 id="项目管理软件"><a href="#项目管理软件" class="headerlink" title="项目管理软件"></a>项目管理软件</h2><p>JIRA，禅道</p>
<h2 id="项⽬中如何解决跨域访问"><a href="#项⽬中如何解决跨域访问" class="headerlink" title="项⽬中如何解决跨域访问"></a>项⽬中如何解决跨域访问</h2><p>使用CORS（Cross-origin resource sharing）跨域资源共享</p>
<p>在微服务的网关中配一个config类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CorsConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CorsFilter</span> <span class="token function">corsFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">CorsConfiguration</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//允许跨域的域名</span>
        <span class="token comment">//响应头中增加这个值Access-Control-Allow-Origin</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">"http://www.wncinema.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">"http://api.wncinema.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedOrigin</span><span class="token punctuation">(</span><span class="token string">"http://admin.wncinema.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//允许客户端发送cookie</span>
        config<span class="token punctuation">.</span><span class="token function">setAllowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设置跨域有效时间的最大时长，单位是秒</span>
<span class="token comment">//        config.setMaxAge(2000000L);</span>

        <span class="token comment">//允许请求的header</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedHeader</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//允许请求的方法</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"PUT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"DELETE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"OPTIONS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">addAllowedMethod</span><span class="token punctuation">(</span><span class="token string">"HEAD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//允许浏览器访问返回的头中的哪些信息</span>
<span class="token comment">//        config.setExposedHeaders(Arrays.asList(</span>
<span class="token comment">//                "Authorization, x-xsrf-token, Access-Control-Allow-Headers, Origin, Accept, X-Requested-With, " +</span>
<span class="token comment">//                "Content-Type, cache-control,pragma,Access-Control-Request-Method, Access-Control-Request-Headers"));</span>
<span class="token comment">//        config.setExposedHeaders(Arrays.asList("Authorization"));</span>

        <span class="token class-name">UrlBasedCorsConfigurationSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlBasedCorsConfigurationSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        source<span class="token punctuation">.</span><span class="token function">registerCorsConfiguration</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">CorsFilter</span> corsFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CorsFilter</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> corsFilter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>如果不是微服务的项目，那么可以在controller的类上增加一个注解@CrossOrigin</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@CrossOrigin</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginController</span> <span class="token keyword">extends</span> <span class="token class-name">BaseController</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>





<h2 id="项⽬中出现了异常怎么处理"><a href="#项⽬中出现了异常怎么处理" class="headerlink" title="项⽬中出现了异常怎么处理"></a>项⽬中出现了异常怎么处理</h2><p>统一异常处理机制</p>
<p>写一个统一异常处理类，加上@ControllerAdvice</p>
<p> 在方法上用注解表示拦截哪种异常@ExceptionHandler(value = Exception.class)</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">exceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">AjaxResult</span> ajax <span class="token operator">=</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token string">"服务端异常（500），请联系管理员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ajax<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">runtimeExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> ex<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">AjaxResult</span> ajax <span class="token operator">=</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">"服务端异常（400），请联系管理员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>ex <span class="token keyword">instanceof</span> <span class="token class-name">BaseException</span> <span class="token operator">||</span> ex <span class="token keyword">instanceof</span> <span class="token class-name">UtilException</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            ajax <span class="token operator">=</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span>ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ex <span class="token keyword">instanceof</span> <span class="token class-name">CustomException</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            ajax <span class="token operator">=</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">CustomException</span><span class="token punctuation">)</span> ex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> ajax<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="17-Mybatis"><a href="#17-Mybatis" class="headerlink" title="17.Mybatis"></a>17.Mybatis</h1><h2 id="MyBatis-逻辑分页和物理分页的区别是什么"><a href="#MyBatis-逻辑分页和物理分页的区别是什么" class="headerlink" title="MyBatis 逻辑分页和物理分页的区别是什么"></a>MyBatis 逻辑分页和物理分页的区别是什么</h2><p>逻辑分页：把数据从数据库中<strong>全部</strong>查出来，然后在内存中进行分页，海量数据，不能使用逻辑分页</p>
<p>物理分页：根据条件，计算当前页应该查询哪些数据，然后从数据库中只查询这些数据，在mysql中使用limit关键字</p>
<h2 id="MyBatis-是否支持延迟加载？延迟加载的原理是什么？"><a href="#MyBatis-是否支持延迟加载？延迟加载的原理是什么？" class="headerlink" title="MyBatis 是否支持延迟加载？延迟加载的原理是什么？"></a>MyBatis 是否支持延迟加载？延迟加载的原理是什么？</h2><p>Mybatis 仅支持 association 关联对象和 collection 关联集合对象的延迟加载，association 指的就是一对一，collection 指的就是一对多查询。在 Mybatis配置文件中，可以配置是否启用延迟加载 lazyLoadingEnabled=true|false。它的原理是，使用 CGLIB 创建目标对象的代理对象，当调用目标方法时，进入拦截器方法，比如调用 a.getB().getName()，拦截器 invoke()方法发现 a.getB()是null 值，那么就会单独发送事先保存好的查询关联 B 对象的 sql，把 B 查询上来，然后调用 a.setB(b)，于是 a 的对象 b 属性就有值了，接着完成 a.getB().getName()方法的调用。这就是延迟加载的基本原理。当然了，不光是 Mybatis，几乎所有的包括 Hibernate，支持延迟加载的原理都是一样的。</p>
<p>延迟加载对象被使用到的时候，通过AOP发送一条语句到数据库，从数据库中查询出来后，封装成对象供调用者使用</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">AObject</span> a<span class="token operator">=</span> <span class="token class-name">AObjectMapper</span><span class="token punctuation">.</span><span class="token function">selectA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//如果设置了延迟加载，这时候，对象a中的b是没有值的</span>
       a<span class="token punctuation">.</span><span class="token function">getB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当需要使用B对象的时候，发送sql语句从数据库中查询B</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BObject</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="MyBatis-有哪些执行器（Executor）"><a href="#MyBatis-有哪些执行器（Executor）" class="headerlink" title="MyBatis 有哪些执行器（Executor）"></a>MyBatis 有哪些执行器（Executor）</h2><p>有三种executor执行器，分别为SimpleExecutor、ReuseExecutor、BatchExecutor。</p>
<p>SimpleExecutor:在每执行一次update或select，就开启一个statement对象，用完后就关闭</p>
<p>ReuseExecutor:在执行update或select时以sql作为key去查找statement，有就直接使用，没有就创建，使用完毕后不关闭，放入Map&lt;String,Statement&gt;中，供下次使用。重复使用statement</p>
<p>BatchExecutor:执行update（jdbc批处理不支持select），会把所有sql添加到批处理中addbatch（）；等待统一批处理executorbatch（）；它缓存了·多个statement，每一个statement都是addbatch（），后等待进行executorbatch（）批处理。</p>
<h2 id="常用的持久层框架有哪些，有什么区别"><a href="#常用的持久层框架有哪些，有什么区别" class="headerlink" title="常用的持久层框架有哪些，有什么区别?"></a>常用的持久层框架有哪些，有什么区别?</h2><p>Hibernate，Mybatis</p>
<p>Hibernate是全自动话的，sql语句是自动生成的，容易引起性能问题。而且学习曲线陡峭。</p>
<p>Mybatis是半自动化的，用户可以自己写sql，控制sql语句的编写，有利于sql的优化。</p>
<h2 id="和∮的区别"><a href="#和∮的区别" class="headerlink" title="#和∮的区别"></a>#和∮的区别</h2><p>#—-预编译，防止sql注入</p>
<p>$—-是字符串拼接，不能防止sql注入</p>
<h2 id="mybatis底层原理"><a href="#mybatis底层原理" class="headerlink" title="mybatis底层原理"></a>mybatis底层原理</h2><p>myatis启动的时候，解析配置文件生成Configuration类，当调用UserMapper.selectUserById的时候，mybatis根据UserMapper的全类限定名加上方法名作为key，找到UserMapper.xml中配置的对应sql语句，执行。</p>
<h2 id="mybatis有哪些核心类"><a href="#mybatis有哪些核心类" class="headerlink" title="mybatis有哪些核心类"></a>mybatis有哪些核心类</h2><ul>
<li>Configuration: 配置类</li>
<li>Environment: 环境信息</li>
<li>SqlSessionFactoryBuilder: SqlSessionFactory 构造者类</li>
<li>SqlSessionFactory: SqlSession 工厂类</li>
<li>SqlSession: 执行 SQL 的一次会话</li>
<li>MappedStatement: 通过 Mapper xml 或注解，生成的 select|update|delete|insert Statement 的封装</li>
</ul>
<h2 id="mapper-xml中的关键标签"><a href="#mapper-xml中的关键标签" class="headerlink" title="mapper.xml中的关键标签"></a>mapper.xml中的关键标签</h2><pre class="line-numbers language-none"><code class="language-none">namespace:配置mapper接口的全限定名&lt;mapper namespace="com.woniu.cinema.mapper.ActorMapper"&gt;

resultMap:定义一个数据列和对象属性的映射关系

collection:定义一对多

association:定义一对一

sql:定义sql语句

select：定义select语句

update:定义update语句

insert:定义insert语句

delete:定义delete语句

使用foreach

delete from tb_actor where actor_id in 
&lt;foreach item="actorId" collection="array" open="(" separator="," close=")"&gt;
#{actorId}
&lt;/foreach&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="18-Redis"><a href="#18-Redis" class="headerlink" title="18.Redis"></a>18.Redis</h1><h2 id="Redis缓存淘汰策略"><a href="#Redis缓存淘汰策略" class="headerlink" title="Redis缓存淘汰策略"></a>Redis缓存淘汰策略</h2><p>1.定时删除：指的是 redis 默认是每隔 100ms 就随机抽取一些设置了过期时间的 key，检查其是否过期，如果过期就删除。</p>
<p>2.惰性删除：在你获取某个 key 的时候，redis 会检查一下 ，这个 key 如果设置了过期时间那么是否过期了？如果过期了此时就会删除，不会给你返回任何东西。</p>
<p><strong>redis 内存淘汰机制有以下几个：</strong></p>
<ul>
<li><p>noeviction: 不删除策略, 达到最大内存限制时, 如果需要更多内存, 直接返回错误信息。 redis默认的设置</p>
</li>
<li><p>volatile-ttl：只限于设置了 expire 的部分; 优先删除剩余时间(time to live,TTL) 短的key。</p>
</li>
<li><p><strong>allkeys-lru：所有key通用; 优先删除最近最少使用(less recently used ,LRU) 的 key。生产环境设置成这个就可以。</strong></p>
</li>
<li><p>allkeys-lfu：所有key通用; 优先删除最近最少使用次数(less frequently used ,LFU) 的 key。生产环境设置成这个就可以。</p>
</li>
<li><p>volatile-lru：只限于设置了 expire 的部分; 优先删除最近最少使用(less recently used ,LRU) 的 key。</p>
</li>
<li><p>volatile-lfu：只限于设置了 expire 的部分; 优先删除最近最少使用次数(less frequently used ,LFU) 的 key。</p>
</li>
<li><p>volatile-random：只限于设置了 expire 的部分; 随机删除一部分 key。</p>
</li>
<li><p>allkeys-random： 所有key通用; 随机删除一部分 key。</p>
</li>
</ul>
<p>LRU算法的实现</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210316174953.png" alt="image-20210316174952998"></p>
<h2 id="Redis持久化方式"><a href="#Redis持久化方式" class="headerlink" title="Redis持久化方式"></a>Redis持久化方式</h2><p><strong>RDB</strong></p>
<p>rdb是内存镜像，二进制的（redis默认开启rdb持久化）</p>
<p>自动触发是由我们的配置文件来完成的。在redis.conf配置文件中：</p>
<p>save 900 1           #表示900秒（15分钟）内有1个更改<br>save 300 10        #300秒（5分钟）内有10个更改<br>save 60 10000   #60秒内有10000个更改</p>
<p>优点：</p>
<ul>
<li>RDB文件紧凑，<strong>全量备份</strong>。</li>
<li>生成RDB文件的时候，redis主进程会fork()一个子进程来处理所有保存工作，主进程不需要进行任何磁盘IO操作。（<strong>异步备份</strong>）</li>
<li>RDB 在恢复大数据集时的速度比 AOF 的<strong>恢复速度快</strong></li>
</ul>
<p>缺点：</p>
<ul>
<li>当进行快照持久化时，会开启一个子进程专门负责快照持久化，子进程会拥有父进程的内存数据，父进程修改内存子进程不会反应出来，所以在快照持久化期间修改的数据不会被保存，<strong>可能丢失数据</strong>。</li>
</ul>
<p><strong>AOF</strong></p>
<p>一种更加高效的备份机制，redis会将每一个收到的写命令都通过write函数追加到文件中。通俗的理解就是日志记录。这个文件是文本文件，每一条命令都以明文方式存储在文件中。（redis默认是不开启AOF，需要修改配置文件才能开启）</p>
<p>AOF的触发方式有三种：</p>
<ul>
<li>每修改同步always：同步持久化 每次发生数据变更会被立即记录到磁盘 性能较差但数据完整性比较好</li>
<li>每秒同步everysec：异步操作，每秒记录 如果一秒内宕机，有数据丢失</li>
<li>不同no：从不同步</li>
</ul>
<p>优点：</p>
<ul>
<li>AOF可以更好的保护数据不丢失，一般AOF会每隔1秒，通过一个后台线程执行一次fsync操作，最多丢失1秒钟的数据。（<strong>更好的保护数据</strong>）</li>
<li>AOF日志文件没有任何磁盘寻址的开销，写入性能非常高，文件不容易破损。AOF日志文件即使过大的时候，出现后台重写操作，也不会影响客户端的读写。（<strong>可读性好</strong>）</li>
<li>AOF日志文件的命令通过非常可读的方式进行记录，这个特性非常适合做灾难性的误删除的紧急恢复。比如某人不小心用flushall命令清空了所有数据，只要这个时候后台rewrite还没有发生，那么就可以立即拷贝AOF文件，将最后一条flushall命令给删了，然后再将该AOF文件放回去，就可以通过恢复机制，自动恢复所有数据（<strong>可读性好</strong>）</li>
</ul>
<p>缺点：</p>
<ul>
<li><p>AOF日志文件通常比RDB数据快照文件更大（<strong>大文件</strong>）</p>
</li>
<li><p>AOF开启后，支持的写QPS会比RDB支持的写QPS低，因为AOF一般会配置成每秒fsync一次日志文件，当然，每秒一次fsync，性能也还是很高的（<strong>性能略有影响</strong>）</p>
</li>
</ul>
<h2 id="Redis中key和value的存储大小限制"><a href="#Redis中key和value的存储大小限制" class="headerlink" title="Redis中key和value的存储大小限制"></a>Redis中key和value的存储大小限制</h2><p>String类型：一个String类型的value最大可以存储512M</p>
<p>List类型：list的元素个数最多为2^31-1个，也就是4294967295个。</p>
<p>Set类型：元素个数最多为2^31-1个，也就是4294967295个。</p>
<p>Hash类型：键值对个数最多为2^31-1个，也就是4294967295个。</p>
<p>Sorted set类型：跟Set类型相似</p>
<h2 id="Redis集群几种模式"><a href="#Redis集群几种模式" class="headerlink" title="Redis集群几种模式"></a>Redis集群几种模式</h2><p><strong>主从配置</strong></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226095757.png" alt="image-20200522115550994"></p>
<p>优点：</p>
<p>搭建简单</p>
<p>缺点：</p>
<p>Master节点宕机后，需要人工介入将slave提升为Master</p>
<p><strong>哨兵模式</strong></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226095931.png" alt="image-20200720114829493"></p>
<p>当master宕机后，哨兵会自动从slave中选一个作为新的master</p>
<p><strong>Redis集群（总共16384个SLOT）</strong></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226100214.png" alt="image-20200721103548666"></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210304170324.png" alt="image-20210304170324167"></p>
<h2 id="Redis的五种数据类型"><a href="#Redis的五种数据类型" class="headerlink" title="Redis的五种数据类型"></a>Redis的五种数据类型</h2><p>string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)</p>
<h2 id="Zset跳跃表"><a href="#Zset跳跃表" class="headerlink" title="Zset跳跃表"></a>Zset跳跃表</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c2841d65df4c">https://www.jianshu.com/p/c2841d65df4c</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wlphp/p/11774171.html">https://www.cnblogs.com/wlphp/p/11774171.html</a></p>
<p>跳表具有如下性质：<br> (1) 由很多层结构组成<br> (2) 每一层都是一个有序的链表<br> (3) 最底层(Level 1)的链表包含所有元素<br> (4) 如果一个元素出现在 Level i 的链表中，则它在 Level i 之下的链表也都会出现。<br> (5) 每个节点包含两个指针，一个指向同一链表中的下一个元素，一个指向下面一层的元素</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225143825.png" alt="image-20210225143825498"></p>
<p>ZSet的使用场景：</p>
<p>排行榜:</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210316162659.png" alt="image-20210316162653330"></p>
<h2 id="分布式锁是怎么实现的"><a href="#分布式锁是怎么实现的" class="headerlink" title="分布式锁是怎么实现的"></a>分布式锁是怎么实现的</h2><h3 id="使用Redission"><a href="#使用Redission" class="headerlink" title="使用Redission"></a>使用Redission</h3><p>引入redission的pom依赖</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.12.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>配置一个config类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedissonConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">//配置一个Redissionclient 实例，放入spring容器</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedissonClient</span> <span class="token function">redissonClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">useSingleServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token string">"redis://127.0.0.1:6379"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedissonClient</span> redissonClient <span class="token operator">=</span> <span class="token class-name">Redisson</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> redissonClient<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-java" data-language="java"><code class="language-java">   <span class="token keyword">void</span> <span class="token function">redissonTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
<span class="token comment">//注意：</span>
       <span class="token comment">//1.要使用try catch finally自己手动释放锁</span>
       <span class="token comment">//2.redission client 有一个看门狗，如果try当中的代码执行时间过长，超过了30秒，redissonClient可以自动续期，保证锁不会消失</span>
       <span class="token class-name">RLock</span> lock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"redisson:goods:1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//redisson:goods:1 这个是放在redis中的key，尽量保持范围要小</span>
       lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">try</span><span class="token punctuation">{</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"执行一些代码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">40000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
           lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>防止重复提交</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token comment">//获取随机数</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"querysn"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">queyrSn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> sn <span class="token operator">=</span> <span class="token string">""</span><span class="token operator">+</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>sn<span class="token punctuation">,</span>sn<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//用户请求查询user信息</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"queryUser"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> sn<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token class-name">Object</span> snInRedis <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>sn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>sn<span class="token punctuation">,</span>snInRedis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//抛异常</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"异常请求"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">RLock</span> lock <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getLock</span><span class="token punctuation">(</span><span class="token string">"LockkeyInRedis"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        snInRedis <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>sn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>sn<span class="token punctuation">,</span>snInRedis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//从数据库查询，或者处理其他业务</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"处理业务逻辑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//        update tb_emp set salary=salary+3000 where id=1;</span>

            <span class="token comment">//执行结束，从redis中删除这个随机数</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>sn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"异常请求"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span> <span class="token keyword">finally</span><span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token string">"ook"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="如何保证缓存数据和数据库的数据一致性"><a href="#如何保证缓存数据和数据库的数据一致性" class="headerlink" title="如何保证缓存数据和数据库的数据一致性"></a>如何保证缓存数据和数据库的数据一致性</h2><ul>
<li>可以使用分布式锁，把更新数据库和更新缓存放在一个原子操作中，但是要注意，锁的粒度要尽量的小；</li>
<li>线程1更新数据库后，把缓存再清除</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226101026.png" alt="image-20210226101026658"></p>
<p><strong>缓存穿透</strong></p>
<p>缓存穿透是指缓存和数据库中都没有的数据，而用户不断发起请求，如发起为id为“-1”的数据或id为特别大不存在的数据。这时的用户很可能是攻击者，攻击会导致数据库压力过大。</p>
<p>解决措施：</p>
<p>缓存取不到的数据，在数据库中也没有取到，这时也可以将key-value对写为key-null</p>
<p><strong>缓存击穿</strong></p>
<p>缓存击穿是指缓存中没有但数据库中有的数据（一般是缓存时间到期），这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力</p>
<p>解决措施：</p>
<ol>
<li><p>设置热点数据永远不过期。</p>
</li>
<li><p>加互斥锁，互斥锁参考代码如下：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226102645.png" alt="image-20210226102645440"></p>
</li>
</ol>
<p><strong>缓存雪崩</strong></p>
<p>大量请求缓存中没有的数据，导致请求同时访问数据库，数据库扛不住压力宕机。</p>
<p>解决措施：</p>
<ol>
<li>缓存数据的过期时间设置随机，防止同一时间大量数据过期现象发生。</li>
<li>如果缓存数据库是分布式部署，将热点数据均匀分布在不同搞得缓存数据库中。</li>
<li>设置热点数据永远不过期。</li>
</ol>
<h1 id="19-Spring有关问题"><a href="#19-Spring有关问题" class="headerlink" title="19.Spring有关问题"></a>19.Spring有关问题</h1><h2 id="Spring如何解决循环依赖"><a href="#Spring如何解决循环依赖" class="headerlink" title="Spring如何解决循环依赖"></a>Spring如何解决循环依赖</h2><ul>
<li>三级缓存</li>
<li>记录实例的半初始化状态</li>
</ul>
<p>注意：如果两个bean都是使用构造函数注入的方式进行实例化，那么无法解决循环依赖的问题。如果两个Bean都配置传给你prototype，那么也无法解决循环依赖；如果有其中任意一个不是用构造函数注入的方式实例化，那么，可以解决循环依赖的问题。</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">//这种配置是可以解决循环依赖的
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dept<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.woniu.domain.Department<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deptName<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>woniu<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user1<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.woniu.domain.User<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zhangsan<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dept<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">//这种配置无法解决循环依赖的问题
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dept<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.woniu.domain.Department<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>woniu<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user1<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.woniu.domain.User<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zhangsan<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dept<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>三级缓存是哪些map；</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** 一级缓存，spring初始化完成后，所有的单例bean都放在这里，是一个线程安全的map */</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> singletonObjects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/** 二级缓存 存储AOP过程中产生的代理对象*/</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> earlySingletonObjects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**三级缓存  value保存的是一个生产bean的工厂 */</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ObjectFactory</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> singletonFactories <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="循环引用会抛出的异常"><a href="#循环引用会抛出的异常" class="headerlink" title="循环引用会抛出的异常"></a>循环引用会抛出的异常</h2><p> org.springframework.beans.factory.<strong>BeanCurrentlyInCreationException</strong>: Error creating bean with name ‘circulationa’: Requested bean is currently in creation: <strong>Is there an unresolvable circular reference?</strong></p>
<h2 id="如果没有二级是否可以？"><a href="#如果没有二级是否可以？" class="headerlink" title="如果没有二级是否可以？"></a>如果没有二级是否可以？</h2><p>如果没有循环依赖和AOP的场景下，二级缓存是不需要的；</p>
<h2 id="Spring-AOP"><a href="#Spring-AOP" class="headerlink" title="Spring AOP"></a>Spring AOP</h2><p>AOP（Aspect Oriented Programming）意为：面向切面编程</p>
<p><strong>AOP就是把系统当中的通用的部分抽象出来放在一个统一的地方实现。</strong></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210227172450.png" alt="image-20210227172450497"></p>
<h2 id="Spring-IOC"><a href="#Spring-IOC" class="headerlink" title="Spring IOC"></a>Spring IOC</h2><p>IOC：控制翻转：把对象的<strong>创建</strong>以及对象之间<strong>依赖关系的组合</strong>交给容器管理。</p>
<p>详细叙述：</p>
<p>Spring 框架的核心是 Spring 容器。容器创建对象，将它们装配在一起，配置它 </p>
<p>们并管理它们的完整生命周期。Spring 容器使用依赖注入来管理组成应用程序的 </p>
<p>组件。容器通过读取提供的配置元数据来接收对象进行实例化，配置和组装的指令</p>
<h2 id="Spring-Bean-的生命周期"><a href="#Spring-Bean-的生命周期" class="headerlink" title="Spring Bean 的生命周期"></a>Spring Bean 的生命周期</h2><ul>
<li><p>spring读取配置文件，生成BeanDefinition，保存在工厂的BeanDefinitonMap中</p>
</li>
<li><p>通过构造函数，创建Bean的实例</p>
</li>
<li><p>调用populateBean给属性赋值</p>
</li>
<li><p>初始化过程中</p>
<p>—–调用Aware接口的方法</p>
<p>—–调用InitializationBean的afterPropertiesSet方法</p>
<p>—–调用用户自己制定的init方法</p>
</li>
<li><p>生成bean实例后放入一级缓存中</p>
</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210507182912.png" alt="image-20210507182912004"></p>
<h2 id="SpringBoot自动配置原理"><a href="#SpringBoot自动配置原理" class="headerlink" title="SpringBoot自动配置原理"></a>SpringBoot自动配置原理</h2><pre class="line-numbers language-none"><code class="language-none">@SpringBootApplication引入了其他两个注解
  --@SpringBootConfiguration
  --@EnableAutoConfiguration
    --读取spring-boot-autoconfigure包里面的spring.factories
      --spring.factories里面配置了各种开发场景下的自动化配置的类，XXXAutoConfiguration
      --这些自动化配置的类里面有@Conditional来决定哪些场景配置哪些类
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224145730.png" alt="image-20210224145730241"></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224150046.png" alt="image-20210224150046447"></p>
<h2 id="Nacos和Eureka比较"><a href="#Nacos和Eureka比较" class="headerlink" title="Nacos和Eureka比较"></a>Nacos和Eureka比较</h2><table>
<thead>
<tr>
<th align="center">功能模块</th>
<th align="center">Nacos</th>
<th align="center">Eureka</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">注册中心</td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center">服务治理基本功能，负责服务中心化注册</td>
</tr>
<tr>
<td align="center">可用区AZ</td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center">对服务集群划分不同区域，实现区域隔离，并提供容灾自动切换</td>
</tr>
<tr>
<td align="center">分组</td>
<td align="center">是</td>
<td align="center"><code>否</code></td>
<td align="center">Nacos可用根据业务和环境进行分组管理</td>
</tr>
<tr>
<td align="center">元数据</td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center">提供服务标签数据，例如环境或服务标识</td>
</tr>
<tr>
<td align="center">权重</td>
<td align="center">是</td>
<td align="center"><code>否</code></td>
<td align="center">Nacos默认提供权重设置功能，调整承载流量压力</td>
</tr>
<tr>
<td align="center">健康检查</td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center">Nacos支持由客户端或服务端发起的健康检查，Eureka是由客户端发起心跳</td>
</tr>
<tr>
<td align="center">负载均衡</td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center">均提供负责均衡策略</td>
</tr>
<tr>
<td align="center">管理界面</td>
<td align="center">是</td>
<td align="center"><code>否</code></td>
<td align="center"><font color="red">Nacos支持对服务在线管理，Eureka只是预览服务状态</font></td>
</tr>
<tr>
<td align="center">MySql</td>
<td align="center">是</td>
<td align="center"><code>否</code></td>
<td align="center"><font color="red">Nacos需要采用MySql进行数据进行持久化</font></td>
</tr>
<tr>
<td align="center">集群</td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center">均支持集群</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">是</td>
<td align="center">是</td>
<td align="center"><font color="red">Eureka只支持AP，Nacos可以在AP和CP模式之间切换</font></td>
</tr>
</tbody></table>
<h2 id="SpringCloud和dubbo的区别"><a href="#SpringCloud和dubbo的区别" class="headerlink" title="SpringCloud和dubbo的区别"></a>SpringCloud和dubbo的区别</h2><p>springcloud是微服务的一整套解决方案，包括服务的监控，远程调用，服务的发现，配置等等</p>
<p>dubbo只是做服务之间的远程调用。</p>
<h2 id="⽹关gateway有了解吗"><a href="#⽹关gateway有了解吗" class="headerlink" title="⽹关gateway有了解吗"></a>⽹关gateway有了解吗</h2><p>zuul—-是netflix这一套springcloud体系中的网关。基于servlet的，并发量比较低</p>
<p>spring cloud gateway–spring团队自己开发的。基于响应式编程，并发量高。</p>
<h2 id="spring常⽤注解"><a href="#spring常⽤注解" class="headerlink" title="spring常⽤注解"></a>spring常⽤注解</h2><p>@Controller/@ResponseBody</p>
<p>@RestController</p>
<p>@RequestMapping</p>
<p>@RequestParam</p>
<p>@PathVariable</p>
<p>@Service</p>
<p>@Autowried</p>
<p>@Component</p>
<h2 id="spring-常⽤的注⼊⽅式有哪些"><a href="#spring-常⽤的注⼊⽅式有哪些" class="headerlink" title="spring 常⽤的注⼊⽅式有哪些"></a>spring 常⽤的注⼊⽅式有哪些</h2><ul>
<li><p>构造函数注入</p>
</li>
<li><p>setter方法注入</p>
</li>
<li><p>基于注解的注入</p>
</li>
<li><h2 id="Fegin怎么进⾏调⽤的"><a href="#Fegin怎么进⾏调⽤的" class="headerlink" title="Fegin怎么进⾏调⽤的"></a>Fegin怎么进⾏调⽤的</h2></li>
</ul>
<p>通过反射，获取到feign接口中的注解上配置的信息，通过动态代理构造出远程调用的代理类，做远程调用</p>
<h2 id="spring-支持几种-bean-的作用域"><a href="#spring-支持几种-bean-的作用域" class="headerlink" title="spring 支持几种 bean 的作用域"></a>spring 支持几种 bean 的作用域</h2><ul>
<li>singleton：单例模式，在整个Spring IoC容器中，使用 singleton 定义的 bean 只有一个实例</li>
<li>prototype：原型模式，每次通过容器的getbean方法获取 prototype 定义的 bean 时，都产生一个新的 bean 实例</li>
<li>request：对于每次 HTTP 请求，使用 request 定义的 bean 都将产生一个新实例，即每次 HTTP 请求将会产生不同的 bean 实</li>
<li>session：同一个 Session 共享一个 bean 实例。</li>
<li>global-session：同 session 作用域不同的是，所有的Session共享一个Bean实例。</li>
</ul>
<h2 id="spring-cloud-的核心组件有哪些"><a href="#spring-cloud-的核心组件有哪些" class="headerlink" title="spring cloud 的核心组件有哪些"></a>spring cloud 的核心组件有哪些</h2><ul>
<li>Eureka注册中心</li>
<li>Config配置中心</li>
<li>ZUUL网关</li>
<li>Hystrix熔断器</li>
<li>Ribbon负载均衡</li>
<li>Feign远程调用</li>
</ul>
<h2 id="spring-cloud-断路器的作⽤是什么"><a href="#spring-cloud-断路器的作⽤是什么" class="headerlink" title="spring cloud 断路器的作⽤是什么"></a>spring cloud 断路器的作⽤是什么</h2><p>Hystrix保护整个系统不会因为某一条调用链路上的响应超时导致整个系统瘫痪。</p>
<p>hystrix断路器有三种状态：</p>
<ul>
<li>关闭</li>
<li>开启</li>
<li>半开</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210225141758.png" alt="image-20210225141758803"></p>
<h2 id="在springcloud中，Eureka宕机了，微服务之间还能调用吗（能）"><a href="#在springcloud中，Eureka宕机了，微服务之间还能调用吗（能）" class="headerlink" title="在springcloud中，Eureka宕机了，微服务之间还能调用吗（能）"></a>在springcloud中，Eureka宕机了，微服务之间还能调用吗（能）</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226145110.png" alt="image-20210226145110369"></p>
<h2 id="⽹关⾥⾯配置哪些东⻄"><a href="#⽹关⾥⾯配置哪些东⻄" class="headerlink" title="⽹关⾥⾯配置哪些东⻄"></a>⽹关⾥⾯配置哪些东⻄</h2><p>最重要的是微服务的服务名和请求路径的映射关系</p>
<h2 id="怎么⽤feign做远程调⽤"><a href="#怎么⽤feign做远程调⽤" class="headerlink" title="怎么⽤feign做远程调⽤"></a>怎么⽤feign做远程调⽤</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"user-service"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserApi</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"findByUserAccountAndPassword"</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">findByUserAccountAndPassword</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userAccount"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> userAccount<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userPassword"</span><span class="token punctuation">)</span>  <span class="token class-name">String</span> userPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"findUserByUserId"</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">findUserByUserId</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="说⼀下熔断器，你怎么⽤的，代码怎么写的"><a href="#说⼀下熔断器，你怎么⽤的，代码怎么写的" class="headerlink" title="说⼀下熔断器，你怎么⽤的，代码怎么写的"></a>说⼀下熔断器，你怎么⽤的，代码怎么写的</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"service-helloworld"</span><span class="token punctuation">,</span>fallback <span class="token operator">=</span> <span class="token class-name">HelloApiFallback</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">HelloApi</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span>GET<span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"/hello"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloApiFallback</span> <span class="token keyword">implements</span> <span class="token class-name">HelloApi</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"服务异常，启动熔断,HelloWorld"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Spring的事务"><a href="#Spring的事务" class="headerlink" title="Spring的事务"></a>Spring的事务</h2><h3 id="编程式事务管理（通过代码实现，不常用）"><a href="#编程式事务管理（通过代码实现，不常用）" class="headerlink" title="编程式事务管理（通过代码实现，不常用）"></a>编程式事务管理（通过代码实现，不常用）</h3><h3 id="声明式事务管理（可以配置在XML中或用注解-Transactional）"><a href="#声明式事务管理（可以配置在XML中或用注解-Transactional）" class="headerlink" title="声明式事务管理（可以配置在XML中或用注解@Transactional）"></a>声明式事务管理（可以配置在XML中或用注解@Transactional）</h3><p>声明式事务管理建立在AOP之上，其本质是对方法前后进行拦截，然后在目标方法开始之前创建或者加入一个事务，执行完目标方法之后根据执行的情况提交或者回滚。</p>
<h3 id="事务的传播机制"><a href="#事务的传播机制" class="headerlink" title="事务的传播机制"></a>事务的传播机制</h3><ul>
<li><strong>PROPAGATION_REQUIRED</strong><br>Spring默认的传播机制，能满足绝大部分业务需求，如果外层有事务，则当前事务加入到外层事务，一块提交，一块回滚。如果外层没有事务，新建一个事务执行。</li>
<li>PROPAGATION_REQUIRED_NEW<br>该事务传播机制是每次都会新开启一个事务，同时把外层事务挂起，当当前事务执行完毕，恢复上层事务的执行。如果外层没有事务，执行当前新开启的事务即可</li>
<li>PROPAGATION_SUPPORT<br>如果外层有事务，则加入外层事务，如果外层没有事务，则直接使用非事务方式执行。完全依赖外层的事务</li>
<li>PROPAGATION_NOT_SUPPORT<br>该传播机制不支持事务，如果外层存在事务则挂起，执行完当前代码，则恢复外层事务，无论是否异常都不会回滚当前的代码</li>
<li>PROPAGATION_NEVER<br>该传播机制不支持外层事务，即如果外层有事务就抛出异常</li>
<li>PROPAGATION_MANDATORY<br>与NEVER相反，如果外层没有事务，则抛出异常</li>
<li>PROPAGATION_NESTED<br>该传播机制的特点是可以保存状态保存点，当前事务回滚到某一个点，从而避免所有的嵌套事务都回滚，即各自回滚各自的，如果子事务没有把异常吃掉，基本还是会引起全部回滚的。</li>
</ul>
<h2 id="springMVC执行流程"><a href="#springMVC执行流程" class="headerlink" title="springMVC执行流程"></a>springMVC执行流程</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226093403.png" alt="image-20210226093403425"></p>
<p>步骤解析:<br>1、用户向服务器发送请求，请求被Spring MVC的前端控制器DispatcherServlet截获；</p>
<p>2、DispatcherServlet对请求URL（统一资源定位符）进行解析，得到URI（请求资源标识符）。然后根据该URI，调用HandlerMapping（处理器映射）获得该Handler配置的所有相关对象，包括Handler对象以及Handler对象对应的拦截器，这些对象会被封装到一个 HandlerExecutionChain对象 当中返回；</p>
<p>3、DispatcherServlet根据获得的Handler，选择一个合适的HandlerAdapter(处理机适配器)。一个HandlerAdapter会被用于处理多种(一类)Handler，并调用Handler实际处理请求的方法；</p>
<p>4、在调用Handler实际处理请求的方法之前，HandlerAdapter(处理机适配器) 首先会结合用户配置对请求消息进行转换(例如，将JSON/XML请求消息转换成一个Java对象)，然后通过DataBinder（数据绑定器）将请求中的模型数据绑定到Handler(Controller)对应的处理方法的参数中。在消息转换和数据绑定过程中，Spring MVC会做一些额外的处理，比如数据类型转换、数据格式化工作和数据合法性校验等；</p>
<p>5、Handler调用业务逻辑组件完成对请求的处理后，向DispatcherServlet返回一个ModelAndView对象，ModelAndView对象中应该包含视图名或者视图名和模型；</p>
<p>6、DispatcherServlet根据返回的ModelAndView对象，选择一个合适的ViewResolver（视图解析器）返回给DispatcherServlet；</p>
<p>7、DispatcherServlet调用视图解析器ViewResolver结合Model来渲染视图View；</p>
<p>8、DispatcherServlet将视图渲染结果返回给客户端。</p>
<p>在以上八个步骤中，DispatcherServlet、HandlerMapping、HandlerAdapter和ViewResolver等核心组件相互配合来完成Spring MVC 请求-响应的整个工作流程。这些核心组件所完成的工作对开发者是透明的，也就是说，开发者并不需要关心这些组件是如何工作的，开发者只需要专注在Handler(Controller)当中完成对请求的业务逻辑处理即可，这也正是MVC框架的价值体现。</p>
<h2 id="controller是单例还是多例？⾼并发下controller怎么保证安全性"><a href="#controller是单例还是多例？⾼并发下controller怎么保证安全性" class="headerlink" title="controller是单例还是多例？⾼并发下controller怎么保证安全性"></a>controller是单例还是多例？⾼并发下controller怎么保证安全性</h2><p><strong>controller默认是单例的，不要使用非静态的成员变量，否则会发生数据逻辑混乱。</strong><br><strong>正因为单例所以不是线程安全的。</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScopeTestController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//定义了实例变量，线程不安全</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/testScope"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token operator">++</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/testScope2"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testScope2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token operator">++</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>不要在controller中定义成员变量。</li>
<li>万一必须要定义一个非静态成员变量时候，则通过注解@Scope(“prototype”)，将其设置为多例模式。</li>
<li>在Controller中使用ThreadLocal变量</li>
</ul>
<h2 id="自定义注解判断是否要做权限检查"><a href="#自定义注解判断是否要做权限检查" class="headerlink" title="自定义注解判断是否要做权限检查"></a>自定义注解判断是否要做权限检查</h2><p>创建一个springboot工程</p>
<p>pom文件中增加</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-aspects<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.13.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>自定义一个注解</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token comment">//定义注解的使用范围，编译时，还是运行时。。。</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>METHOD<span class="token punctuation">)</span><span class="token comment">//定义注解用在哪里class，method。。。</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Login</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>定义一个aop的类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAop</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"execution(public * com.woniu30.aop.annotation.aopannotation.controller.DemoController.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">"pt()"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deBefore</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span>  <span class="token punctuation">{</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Class</span> clazz <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> methodName <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Method</span> method <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Login</span> loginAnno <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Login</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>loginAnno<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"检查用户是否登录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"不用检查用户是否登录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>启动类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableAspectJAutoProxy</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AopAnnotationApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">AopAnnotationApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>controller类</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"hello1"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Login</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello1</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"hello1:"</span><span class="token operator">+</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"hello2"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello2</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"hello2:"</span><span class="token operator">+</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>访问<a target="_blank" rel="noopener" href="http://localhost:8080/hello2?name=zhangsan%E4%B8%8D%E9%9C%80%E8%A6%81%E7%99%BB%E5%BD%95%E6%A3%80%E6%9F%A5">http://localhost:8080/hello2?name=zhangsan不需要登录检查</a></p>
<p>访问<a target="_blank" rel="noopener" href="http://localhost:8080/hello1?name=zhangsan%E9%9C%80%E8%A6%81%E7%99%BB%E5%BD%95%E6%A3%80%E6%9F%A5">http://localhost:8080/hello1?name=zhangsan需要登录检查</a></p>
<h1 id="20-shiro授权的流程"><a href="#20-shiro授权的流程" class="headerlink" title="20.shiro授权的流程"></a>20.shiro授权的流程</h1><p><strong>Subject：</strong>主体，可以看到主体可以是任何可以与应用交互的“用户”；</p>
<p><strong>SecurityManager：</strong>Shiro的心脏；所有具体的交互都通过SecurityManager进行控制；负责所有Subject、且负责进行认证和授权、及会话、缓存的管理。</p>
<ul>
<li>Authenticator：认证器，判断用户是否正常登陆</li>
<li>Authorizer：授权器，判断用户是否有权限操作资源</li>
</ul>
<p><strong>Realm：</strong>可以有1个或多个Realm，主要提供认证和授权的数据；</p>
<p><strong>Session：</strong>Shiro提供一个权限的企业级Session解决方案，session的生命周期都在SessionManager中进行管理。</p>
<p><strong>SessionManager：</strong>shiro的会话管理器；</p>
<p><strong>SessionDAO：</strong>用于会话的CRUD，比如存储到ehcache或者redis中的会话增删改查；</p>
<p><strong>CacheManager：</strong>缓存控制器，来管理如用户、角色、权限等的缓存的；因为这些数据基本上很少去改变，放到缓存中后可以提高访问的性能</p>
<p><strong>Cryptography：</strong>密码模块，Shiro提高了一些常见的加密组件用于如密码加密/解密的。</p>
<p>详情参考</p>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000022564101">https://segmentfault.com/a/1190000022564101</a></p>
<h1 id="21-设计模式"><a href="#21-设计模式" class="headerlink" title="21.设计模式"></a>21.设计模式</h1><p>单例模式：</p>
<p><strong>1.饿汉式</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton01</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton01</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Singleton01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton01</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点：实现简单，调用效率高（提前完成初始化），线程安全</p>
<p>缺点： 在不需要的时候可能就加载了，造成内存浪费</p>
<p><strong>2.懒汉式</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton02</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton02</span> instance<span class="token punctuation">;</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Singleton02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton02</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//多线程的时候会同时到这个点</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点：只在使用时加载，节省资源</p>
<p>缺点： 存在线程安全问题</p>
<p><strong>3.懒汉式改进版</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton02</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton02</span> instance<span class="token punctuation">;</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Singleton02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token class-name">Singleton02</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>没有线程安全问题，但是并发性降低了</p>
<p><strong>3.双重检测</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton03</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton03</span> instance<span class="token punctuation">;</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Singleton03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton03</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        ①
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton03</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         ②
                <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                ③
                    instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      ④
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点： 只在使用时加载，节省资源</p>
<p>缺点：也存在线程安全问题</p>
<p>具体原因如下：代码④一行，正常的执行顺序为：</p>
<p>1.分配内存空间  2.初始化对象 3.instance指向对象</p>
<p>但是由于jvm存在重排序，可能顺序变成1-&gt;3-&gt;2</p>
<p>这个时候如果有线程调用getInstance方法，走代码①一行，直接就会返回instance，但是这个时候可能instance的构造函数</p>
<p>还没有初始化完毕，发生错误。</p>
<p>一种解决方案是在instance的变量使用volitile关键字声明，来解决重排序的问题。</p>
<p><strong>4.枚举方式</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span>  <span class="token class-name">Singleton04</span> <span class="token punctuation">{</span>
    <span class="token comment">// 单例对象</span>
    INSTANCE<span class="token punctuation">;</span>
 
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doSomething"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Singleton04</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点：实现简单，线程安全，防止反射攻击等。</p>
<p>缺点： 在不需要的时候可能就加载了，造成内存浪费</p>
<p><strong>5.静态内部类</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton05</span> <span class="token punctuation">{</span>
 
    <span class="token keyword">private</span> <span class="token class-name">Singleton05</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHolder</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton05</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton05</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton05</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">SingletonHolder</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点：在需要的时候加载，线程安全</p>
<p>静态内部类的具体原理参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/worldchinalee/article/details/101012199">https://blog.csdn.net/worldchinalee/article/details/101012199</a></p>
<h1 id="22-其他"><a href="#22-其他" class="headerlink" title="22.其他"></a>22.其他</h1><h2 id="⽤户在浏览器输⼊了url，点击回⻋后，说⼀下浏览器，⽹络和服务器都做了哪些操作"><a href="#⽤户在浏览器输⼊了url，点击回⻋后，说⼀下浏览器，⽹络和服务器都做了哪些操作" class="headerlink" title="⽤户在浏览器输⼊了url，点击回⻋后，说⼀下浏览器，⽹络和服务器都做了哪些操作"></a>⽤户在浏览器输⼊了url，点击回⻋后，说⼀下浏览器，⽹络和服务器都做了哪些操作</h2><ul>
<li>根据URL中的域名（<a target="_blank" rel="noopener" href="http://www.baidu.com)通过dns解析出ip地址/">www.baidu.com）通过DNS解析出IP地址</a></li>
<li>把IP地址转换成MAC地址</li>
<li>建立TCP连接</li>
<li>发送数据给服务器</li>
<li>服务端处理请求后，根据发送方的IP地址，返回响应的数据</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210223164659.png" alt="image-20210223164658974"></p>
<h2 id="正则表达式匹配IP-192-168-1-23"><a href="#正则表达式匹配IP-192-168-1-23" class="headerlink" title="正则表达式匹配IP(192.168.1.23)"></a>正则表达式匹配IP(192.168.1.23)</h2><pre class="line-numbers language-none"><code class="language-none">ss=re.compile(r'((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.){3}(1\d\d|2[0-4]\d|25[0-5]|[1-9]\d|\d)')<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>解释：</p>
<p>. 匹配除换行符以外的任意字符</p>
<p>\w 匹配字母或数字或下划线或汉字 等价于 ‘[^A-Za-z0-9_]’。</p>
<p>\s 匹配任意的空白符</p>
<p>\d 匹配数字</p>
<p>\b 匹配单词的开始或结束</p>
<p>^ 匹配字符串的开始</p>
<p>$ 匹配字符串的结束</p>
<p>[1-9]代表1-9中的任何一个数字</p>
<h2 id="比较一下-和equals的区别-1"><a href="#比较一下-和equals的区别-1" class="headerlink" title="比较一下==和equals的区别"></a>比较一下==和equals的区别</h2><p>默认在Object里面是没有区别，都是==,比较对象的内存地址</p>
<p>在子类里面，一般我们都会重写equals方法，同时也会重写hashCode方法</p>
<pre class="line-numbers language-none"><code class="language-none">两个对象Obj1和Obj2，如果Obj1.equals(Obj2),那么Obj1.hashCode==Obj2.hashCode一定为true
如果Obj1.hashCode==Obj2.hashCode，那么Obj1.equals(Obj2)不一定为true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h2 id="JDK8的新特性"><a href="#JDK8的新特性" class="headerlink" title="JDK8的新特性"></a>JDK8的新特性</h2><p><strong>default关键字</strong></p>
<p>可以在接口中定义默认的实现方法</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserApi</span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">defaultMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"演示一下jdk8中的默认接口"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>函数式接口</strong></p>
<p>是指仅仅只包含一个抽象方法的接口，每一个该类型的lambda表达式都会被匹配到这个抽象方法。jdk1.8提供了一个@FunctionalInterface注解来定义函数式接口</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MyLamda</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token class-name">String</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//这里如果继续加一个抽象方法便会报错</span>
<span class="token comment">//    public void test1();</span>
    
<span class="token comment">//default方法可以任意定义</span>
    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"123"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"123"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">//static方法也可以定义</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>lambda表达式</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">,</span><span class="token string">"fsa"</span><span class="token punctuation">,</span><span class="token string">"ser"</span><span class="token punctuation">,</span><span class="token string">"eere"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span>o2<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> o2<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>o1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> string <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>流</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"lisi"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"wangwu"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//串行流</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserVo</span><span class="token punctuation">&gt;</span></span> userVoList <span class="token operator">=</span> userList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>u <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">UserVo</span> userVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userVo<span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" 的家"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userVo<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userVo<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> userVo<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//并行流</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserVo</span><span class="token punctuation">&gt;</span></span> userVoList <span class="token operator">=</span> userList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>u <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">UserVo</span> userVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userVo<span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" 的家"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userVo<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userVo<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> userVo<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//map reduce</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestStudent2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> stuList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"刘一"</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"陈二"</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"赵六"</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"孙七"</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"周八"</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"吴九"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"郑十"</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//以前写法</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> student <span class="token operator">:</span> stuList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum<span class="token operator">=</span>sum<span class="token operator">+</span>student<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"学生总分："</span><span class="token operator">+</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//计算学生总分</span>
        <span class="token class-name">Integer</span> totalScore1 <span class="token operator">=</span> stuList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token operator">::</span><span class="token function">getScore</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>totalScore1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">//排序</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestStudent2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> stuList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"刘一"</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"陈二"</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"赵六"</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"孙七"</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"周八"</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"吴九"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stuList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"郑十"</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//以前写法</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> student <span class="token operator">:</span> stuList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sum<span class="token operator">=</span>sum<span class="token operator">+</span>student<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"学生总分："</span><span class="token operator">+</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//计算学生总分</span>
        <span class="token class-name">Integer</span> totalScore1 <span class="token operator">=</span> stuList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token operator">::</span><span class="token function">getScore</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>totalScore1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>Date Api更新</strong></p>
<p>LocalDate/LocalTime/LocalDateTime</p>
<p>LocalDate为日期处理类、LocalTime为时间处理类、LocalDateTime为日期时间处理类</p>
<h2 id="幂等性如何实现"><a href="#幂等性如何实现" class="headerlink" title="幂等性如何实现"></a>幂等性如何实现</h2><p>幂等操作：如果对一个接口多次操作结果不变，接口具备幂等性；如果多次操作结果不同，那么接口不具备幂等性</p>
<ul>
<li>使用数据库的唯一索引就可以是先insert的幂等性</li>
<li>对于更新操作可以在数据库表中增加一个version版本号来控制</li>
</ul>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210224101707.png" alt="image-20210224101706952"></p>
<h2 id="不用数据库主键，防止重复提交"><a href="#不用数据库主键，防止重复提交" class="headerlink" title="不用数据库主键，防止重复提交"></a>不用数据库主键，防止重复提交</h2><p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210226141600.png" alt="image-20210226141600035"></p>
<h2 id="你们的项⽬是如何进⾏单元测试的？⽤什么软件测试代码覆盖率？"><a href="#你们的项⽬是如何进⾏单元测试的？⽤什么软件测试代码覆盖率？" class="headerlink" title="你们的项⽬是如何进⾏单元测试的？⽤什么软件测试代码覆盖率？"></a>你们的项⽬是如何进⾏单元测试的？⽤什么软件测试代码覆盖率？</h2><p>没有写单元测试，公司使用SonarQube来监测代码质量</p>
<h2 id="使⽤过哪些加密算法"><a href="#使⽤过哪些加密算法" class="headerlink" title="使⽤过哪些加密算法"></a>使⽤过哪些加密算法</h2><p>MD5，RSA，SHA256</p>
<h2 id="CAP理论"><a href="#CAP理论" class="headerlink" title="CAP理论"></a>CAP理论</h2><p>CAP理论作为分布式系统的基础理论,它描述的是一个分布式系统在以下三个特性中：</p>
<ul>
<li>一致性（<strong>C</strong>onsistency）</li>
<li>可用性（<strong>A</strong>vailability）</li>
<li>分区容错性（<strong>P</strong>artition tolerance）</li>
</ul>
<p>最多满足其中的两个特性。也就是下图所描述的。分布式系统要么满足CA,要么CP，要么AP。无法同时满足CAP。</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210317115927.png" alt="image-20210317115926978"></p>
<p><strong>I.</strong> 什么是 一致性、可用性和分区容错性</p>
<p><strong>分区容错性</strong>：指的分布式系统中的某个节点或者网络分区出现了故障的时候，整个系统仍然能对外提供满足一致性和可用性的服务。也就是说部分故障不影响整体使用。</p>
<p>事实上我们在设计分布式系统是都会考虑到bug,硬件，网络等各种原因造成的故障，所以即使部分节点或者网络出现故障，我们要求整个系统还是要继续使用的</p>
<p>(不继续使用,相当于只有一个分区,那么也就没有后续的一致性和可用性了)</p>
<p><strong>可用性：</strong> 一直可以正常的做读写操作。简单而言就是客户端一直可以正常访问并得到系统的正常响应。用户角度来看就是不会出现系统操作失败或者访问超时等问题。</p>
<p><strong>一致性</strong>：在分布式系统完成某写操作后任何读操作，都应该获取到该写操作写入的那个最新的值。相当于要求分布式系统中的各节点时时刻刻保持数据的一致性。</p>
<p><strong>II.</strong> 该怎么理解</p>
<p>如果我们<strong>事先保证了分区容错性</strong>，也意味着若某个节点故障了，用户还是可以继续访问。这时用户在访问过程中就会出现一致性和可用性不能同时满足的情况，参考下图：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210317120401.png" alt="image-20210317120401125"></p>
<p>如图假设分布式系统有G1，G2两个节点，初始值都是v0。现在有一个client向系统写入了值v1，这里假设直接写的是节点G1。写完之后client再去读取这个值，这时读到了G2节点,</p>
<p>由于G2节点与G1节点失去连接，这时G1节点上的数据还未同步到G2节点，因此客户端读取到的是修改之前的值v0。 这就出现了不满足一致性的情况了。相当于<strong>满足了可用性，失去了一致性</strong>。</p>
<p>类似的，如果系统保证了强的一致性，那么在client 写完G1节点后, 而G1向G2节点同步数据出现了问题，这时如果client再去读取G2节点的数据时，client就会一直处于等待状态，因为系统内各节点</p>
<p>数据为同步上，需要等同步上才能使用。这就相当于<strong>满足了一致性，而失去了可用性</strong>。</p>
<p><strong>III.</strong> CAP三者不可兼得，该如何取舍：</p>
<p>(1) CA: 优先保证一致性和可用性，放弃分区容错。 这也意味着放弃系统的扩展性，系统不再是分布式的，有违设计的初衷。Eureka</p>
<p>(2) CP: 优先保证一致性和分区容错性，放弃可用性。在数据一致性要求比较高的场合(譬如:zookeeper,Hbase) 是比较常见的做法，一旦发生网络故障或者消息丢失，就会牺牲用户体验，等恢复之后用户才逐渐能访问。</p>
<p>(3) AP: 优先保证可用性和分区容错性，放弃一致性。NoSQL中的Cassandra 就是这种架构。跟CP一样，放弃一致性不是说一致性就不保证了，而是逐渐的变得一致。</p>
<h2 id="BASE理论"><a href="#BASE理论" class="headerlink" title="BASE理论"></a>BASE理论</h2><p>BASE理论是Basically Available(基本可用)，Soft State（软状态）和Eventually Consistent（最终一致性）三个短语的缩写。</p>
<ul>
<li>基本可用（Basically Available）</li>
<li>软状态（Soft State）</li>
<li>最终一致性（Eventually Consistent）</li>
</ul>
<h1 id="23-杂项"><a href="#23-杂项" class="headerlink" title="23.杂项"></a>23.杂项</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p><strong>1.雪花算法生成的主键是19位长整型，但是js只能处理16位长整型，最后三位会被截掉。解决方法是把19位整数变成字符串传给前端。</strong></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210427153251.png" alt="image-20210427153245969"></p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210427153355.png" alt="image-20210427153355196"></p>
<p><strong>2.BigDecimal问题：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BigDecimal</span> param1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BigDecimal</span> param2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//加法</span>
    <span class="token class-name">BigDecimal</span> add <span class="token operator">=</span> param1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>param2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"加法："</span> <span class="token operator">+</span> add<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//减法</span>
    <span class="token class-name">BigDecimal</span> subtract <span class="token operator">=</span> param2<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>param1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"减法："</span> <span class="token operator">+</span> subtract<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//乘法</span>
    <span class="token class-name">BigDecimal</span> multiply <span class="token operator">=</span> param1<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>param2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"乘法："</span> <span class="token operator">+</span> multiply<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//除法</span>
    <span class="token class-name">BigDecimal</span> divide <span class="token operator">=</span> param2<span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>param1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"除法："</span> <span class="token operator">+</span> divide<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>结果是我们期望的：</p>
<p><img src="https://woniumd.oss-cn-hangzhou.aliyuncs.com/java/yangguang/20210506173914.png" alt="image-20210506173907770"></p>
<p>如何解决呢：把这个初始化的方法修改为传字符串</p>
<pre class="line-numbers language-none"><code class="language-none">BigDecimal param1 = new BigDecimal(0.1);
BigDecimal param2 = new BigDecimal(0.2);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>修改后：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">BigDecimal</span> param1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">"0.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BigDecimal</span> param2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token string">"0.2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<p><strong>3.java并发修改异常 java.util.ConcurrentModificationException：</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Integer</span> integer <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>integer<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span>
      list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>运行这段代码会遇到如下异常</p>
<p>Exception in thread “main” java.util.ConcurrentModificationException<br>    at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:909)<br>    at java.util.ArrayList$Itr.next(ArrayList.java:859)<br>    at com.woniu34.eureka.Test.main(Test.java:15)</p>
<p>原因是使用Iterator循环集合的时候，会执行检查,如果modCount != expectedModCount就会抛出异常，上面的代码在删除元素的时候用了list.remove(integer)不会把modCount修改成和expectedModCount一致。</p>
<pre class="line-numbers language-none"><code class="language-none">final void checkForComodification() {
    if (modCount != expectedModCount)
    throw new ConcurrentModificationException();
}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p>解决方法：</p>
<p>使用Iterator的删除方法，不要使用集合本身的删除方法</p>
<p>把上面代码中的list.remove(integer) 修改成 <code>iterator.remove();  </code>就可以了</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Samuel·RK</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://samuelrk.github.io/2021/10/14/20211014%E5%85%AB%E8%82%A1%E6%96%87%E6%80%BB%E7%BB%93/">https://samuelrk.github.io/2021/10/14/20211014%E5%85%AB%E8%82%A1%E6%96%87%E6%80%BB%E7%BB%93/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Samuel·RK</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Java/">
                                    <span class="chip bg-color">Java</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    
        
    <div id="SOHUCS"></div>
    <script type="text/javascript">
        window.onload = function () {
            var loadChangYan = function () {
                var appid = 'cyvtPjw5T';
                var conf = 'prod_e243f1002cb5e50873ff007358151ef7';
                var width = window.innerWidth || document.documentElement.clientWidth;
                if (width < 960) {
                    var head = document.getElementsByTagName('head')[0] || document.head || document.documentElement;
                    var script = document.createElement('script');
                    script.type = 'text/javascript';
                    script.charset = 'utf-8';
                    script.id = 'changyan_mobile_js';
                    script.src = 'https://cy-cdn.kuaizhan.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid +
                        '&conf=' + conf;
                    head.appendChild(script);
                } else {
                    var loadJs = function (d, a) {
                        var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
                        var b = document.createElement("script");
                        b.setAttribute("type", "text/javascript");
                        b.setAttribute("charset", "UTF-8");
                        b.setAttribute("src", d);
                        if (typeof a === "function") {
                            if (window.attachEvent) {
                                b.onreadystatechange = function () {
                                    var e = b.readyState;
                                    if (e === "loaded" || e === "complete") {
                                        b.onreadystatechange = null;
                                        a()
                                    }
                                }
                            } else {
                                b.onload = a
                            }
                        }
                        c.appendChild(b)
                    };
                    loadJs("https://cy-cdn.kuaizhan.com/upload/changyan.js", function () {
                        window.changyan.api.config({
                            appid: appid,
                            conf: conf
                        })
                    });
                }
            }

            loadChangYan();
        }
    </script>

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/10/14/20211014%E5%85%AB%E8%82%A1%E6%96%87%E6%80%BB%E7%BB%93/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/load_8.jpg" class="responsive-img" alt="八股文总结">
                        
                        <span class="card-title">八股文总结</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-10-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Samuel·RK
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java/">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/06/12/20210612%E5%8D%8A%E5%B9%B4%E6%80%BB%E7%BB%93/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/load_3.jpg" class="responsive-img" alt="半年总结">
                        
                        <span class="card-title">半年总结</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-12
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Samuel·RK
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E9%9A%8F%E7%AC%94/">
                        <span class="chip bg-color">随笔</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="617330529"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">Samuel·RK</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "5";
                        var startDate = "29";
                        var startHour = "19";
                        var startMinute = "10";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">








    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1466634585" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1466634585" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 这个clickvalue是我自己写的，我不喜欢那个爱心 -->
    
    <script src="/libs/others/clickvalue.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
